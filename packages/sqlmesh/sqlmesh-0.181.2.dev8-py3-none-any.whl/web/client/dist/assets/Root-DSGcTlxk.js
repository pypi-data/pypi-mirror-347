var en=Object.defineProperty;var tn=(e,t,n)=>t in e?en(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var oe=(e,t,n)=>tn(e,typeof t!="symbol"?t+"":t,n);import{r as s,j as o,N as nn,c as _,b as V,d as Lt,a as E,e as Y,R as C,f as Qe,g as Le,h as le,k as it,l as ct,B as et,m as St,n as tt,o as $t,L as rn,S as nt,p as an,q as sn,s as on,t as Dt,v as Ot,w as S,x as ln,i as $,y as cn,z as un,A as dn,C as qe,D as fn,F as mn,G as Et,H as hn,I as yt,O as pn}from"./index-COnjINWU.js";import{R as vn}from"./ReportErrors-BK8N5y1z.js";import{u as y,M as gn,a as rt,E as ce}from"./plan-BwAtu9hd.js";import{G as wn,w as xn,E as B,P as jt,S as bn}from"./SelectEnvironment-CJsiOTlU.js";import{o as U,U as de,y as fe,l as Ht,n as Bt,a as En,u as be,s as Te,O as Me,M as ue,p as yn,b as Ct,c as kt,C as me,d as jn,e as ne,f as Zt,E as It,t as zt,N as Cn,g as kn,h as _t,i as ut,I as Ee,j as Rn,k as Fe,m as An,q as Nn,r as Pn,v as at,w as st,x as Rt,z as Tn,A as Fn,B as At,D as ot}from"./transition-DjPYSO2n.js";import{F as Mn}from"./ChevronRightIcon-CknBR_Ye.js";import{u as X,M as Ue}from"./project-CWUUCZWT.js";import{M as Nt}from"./file-C7afm_LM.js";import{u as ee,c as Ln}from"./editor-B2GioI_r.js";import{EnumFileExplorerChange as Ge}from"./context-DmjvuTWz.js";import"./PlusCircleIcon-CcC2lSkc.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./SplitPane-BSlIdmc8.js";import"./context-APidk_GA.js";import"./Input-CJirBrKe.js";import"./help-6Q7f7fjd.js";import"./SourceList-FVjgH2xJ.js";import"./index-CK4fdw8q.js";import"./ModelLineage-B8hv0xJ-.js";import"./ListboxShow-C0DBUX71.js";import"./SearchList-B9NnvRod.js";import"./ChevronDownIcon-DhkdL7W7.js";function Sn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z",clipRule:"evenodd"}))}const $n=s.forwardRef(Sn);function Dn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"}))}const On=s.forwardRef(Dn);function Hn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M3 3.5A1.5 1.5 0 0 1 4.5 2h6.879a1.5 1.5 0 0 1 1.06.44l4.122 4.12A1.5 1.5 0 0 1 17 7.622V16.5a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 3 16.5v-13Zm10.857 5.691a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 0 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z",clipRule:"evenodd"}))}const Bn=s.forwardRef(Hn);function Zn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M4.5 2A1.5 1.5 0 0 0 3 3.5v13A1.5 1.5 0 0 0 4.5 18h11a1.5 1.5 0 0 0 1.5-1.5V7.621a1.5 1.5 0 0 0-.44-1.06l-4.12-4.122A1.5 1.5 0 0 0 11.378 2H4.5Zm2.25 8.5a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Zm0 3a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Z",clipRule:"evenodd"}))}const In=s.forwardRef(Zn);function zn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495ZM10 5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 10 5Zm0 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z",clipRule:"evenodd"}))}const _n=s.forwardRef(zn);function Vn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{d:"M3.75 3A1.75 1.75 0 0 0 2 4.75v3.26a3.235 3.235 0 0 1 1.75-.51h12.5c.644 0 1.245.188 1.75.51V6.75A1.75 1.75 0 0 0 16.25 5h-4.836a.25.25 0 0 1-.177-.073L9.823 3.513A1.75 1.75 0 0 0 8.586 3H3.75ZM3.75 9A1.75 1.75 0 0 0 2 10.75v4.5c0 .966.784 1.75 1.75 1.75h12.5A1.75 1.75 0 0 0 18 15.25v-4.5A1.75 1.75 0 0 0 16.25 9H3.75Z"}))}const Wn=s.forwardRef(Vn);function Yn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm6.39-2.908a.75.75 0 0 1 .766.027l3.5 2.25a.75.75 0 0 1 0 1.262l-3.5 2.25A.75.75 0 0 1 8 12.25v-4.5a.75.75 0 0 1 .39-.658Z",clipRule:"evenodd"}))}const Vt=s.forwardRef(Yn);function qn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M9.661 2.237a.531.531 0 0 1 .678 0 11.947 11.947 0 0 0 7.078 2.749.5.5 0 0 1 .479.425c.069.52.104 1.05.104 1.59 0 5.162-3.26 9.563-7.834 11.256a.48.48 0 0 1-.332 0C5.26 16.564 2 12.163 2 7c0-.538.035-1.069.104-1.589a.5.5 0 0 1 .48-.425 11.947 11.947 0 0 0 7.077-2.75Zm4.196 5.954a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z",clipRule:"evenodd"}))}const Un=s.forwardRef(qn);function Gn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{d:"M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785l-.238-1.192ZM6.949 5.684a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633L6.95 5.684ZM13.949 13.684a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632l-.183-.551Z"}))}const Pt=s.forwardRef(Gn);function Kn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{fillRule:"evenodd",d:"M.99 5.24A2.25 2.25 0 0 1 3.25 3h13.5A2.25 2.25 0 0 1 19 5.25l.01 9.5A2.25 2.25 0 0 1 16.76 17H3.26A2.267 2.267 0 0 1 1 14.74l-.01-9.5Zm8.26 9.52v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75v.615c0 .414.336.75.75.75h5.373a.75.75 0 0 0 .627-.74Zm1.5 0a.75.75 0 0 0 .627.74h5.373a.75.75 0 0 0 .75-.75v-.615a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75v.625Zm6.75-3.63v-.625a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75v.625c0 .414.336.75.75.75h5.25a.75.75 0 0 0 .75-.75Zm-8.25 0v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75v.625c0 .414.336.75.75.75H8.5a.75.75 0 0 0 .75-.75ZM17.5 7.5v-.625a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75V7.5c0 .414.336.75.75.75h5.25a.75.75 0 0 0 .75-.75Zm-8.25 0v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75V7.5c0 .414.336.75.75.75H8.5a.75.75 0 0 0 .75-.75Z",clipRule:"evenodd"}))}const Tt=s.forwardRef(Kn);function Jn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 0 1 9 9v.375M10.125 2.25A3.375 3.375 0 0 1 13.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 0 1 3.375 3.375M9 15l2.25 2.25L15 12"}))}const Xn=s.forwardRef(Jn);function Qn({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const er=s.forwardRef(Qn);function tr({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const nr=s.forwardRef(tr);function rr({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"}))}const ar=s.forwardRef(rr);function sr({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"}))}const Wt=s.forwardRef(sr);function or({title:e,titleId:t,...n},r){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":t},n),e?s.createElement("title",{id:t},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const lr=s.forwardRef(or);function q({title:e,to:t,icon:n,iconActive:r,classActive:i="px-2 bg-neutral-10",disabled:l=!1,children:u,before:c,className:d}){return o.jsx(nn,{title:e,to:t,className:({isActive:v})=>_("flex items-center",l&&"opacity-50 cursor-not-allowed",v&&V(l)&&i,d),style:({isActive:v})=>v||l?{pointerEvents:"none"}:{},children:({isActive:v})=>o.jsxs("span",{className:_("flex items-center",v?"font-bold":"font-normal"),children:[c,v?r:n,u]})})}function ir({className:e}){const{errors:t}=Lt(),n=E(l=>l.models),r=E(l=>l.modules),i=Array.from(new Set(n.values())).length;return o.jsxs("div",{className:e,children:[r.hasEditor&&o.jsx(q,{title:"File Explorer",to:Y.Editor,className:"px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-primary-500 rounded-xl my-1",classActive:"bg-primary-10 text-primary-500",icon:o.jsx(ar,{className:"min-w-6 w-6"}),iconActive:o.jsx(Wn,{className:"min-w-6 w-6"})}),r.hasDataCatalog&&o.jsx(q,{title:"Data Catalog",to:Y.DataCatalog,icon:o.jsx(er,{className:"min-w-6 w-6"}),iconActive:o.jsx(In,{className:"min-w-6 w-6"}),className:"relative rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-600 dark:text-neutral-300",children:o.jsx("span",{className:"min-w-[1rem] px-1 h-4 py-0.5 text-center text-[9px] absolute bottom-0 right-0 font-black rounded-full bg-primary-500 text-primary-100",children:i})}),r.hasErrors&&o.jsx(q,{title:"Errors",to:Y.Errors,className:_("relative px-2 py-1 rounded-xl my-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10",t.size>0?"text-danger-500":"text-neutral-600"),classActive:"px-2 bg-danger-10 text-danger-500",icon:o.jsx(nr,{className:"w-6"}),iconActive:o.jsx(_n,{className:"w-6"}),disabled:t.size===0,children:t.size>0&&o.jsx("span",{className:"min-w-[1rem] px-1 h-4 py-0.5 text-center text-[9px] absolute bottom-0 right-0 font-black rounded-full bg-danger-500 text-danger-100",children:t.size})}),r.hasPlans&&o.jsx(q,{title:"Plan",to:Y.Plan,className:"px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-success-500 rounded-xl my-1",classActive:"bg-success-10 text-success-500",icon:o.jsx(Wt,{className:"w-6"}),iconActive:o.jsx(Vt,{className:"w-6"})}),r.hasTests&&o.jsx(q,{title:"Tests",to:Y.Tests,icon:o.jsx(Xn,{className:"w-6"}),iconActive:o.jsx(Bn,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10"}),r.hasAudits&&o.jsx(q,{title:"Audits",to:Y.Audits,icon:o.jsx(lr,{className:"w-6"}),iconActive:o.jsx(Un,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10"}),r.hasData&&o.jsx(q,{title:"Data",to:Y.Data,icon:o.jsx(Tt,{className:"w-6"}),iconActive:o.jsx(Tt,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-500 dark:text-neutral-300"}),r.hasLineage&&o.jsx(q,{title:"Lineage",to:Y.Lineage,icon:o.jsx(Pt,{className:"w-6"}),iconActive:o.jsx(Pt,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-500 dark:text-neutral-300"})]})}function dt(e,t){let n=s.useRef([]),r=U(e);s.useEffect(()=>{let i=[...n.current];for(let[l,u]of t.entries())if(n.current[l]!==u){let c=r(t,i);return n.current=t,c}},[r,...t])}function cr(e){function t(){document.readyState!=="loading"&&(e(),document.removeEventListener("DOMContentLoaded",t))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",t),t())}let Q=[];cr(()=>{function e(t){t.target instanceof HTMLElement&&t.target!==document.body&&Q[0]!==t.target&&(Q.unshift(t.target),Q=Q.filter(n=>n!=null&&n.isConnected),Q.splice(10))}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})});function Yt(e){if(!e)return new Set;if(typeof e=="function")return new Set(e());let t=new Set;for(let n of e.current)n.current instanceof HTMLElement&&t.add(n.current);return t}let ur="div";var qt=(e=>(e[e.None=1]="None",e[e.InitialFocus=2]="InitialFocus",e[e.TabLock=4]="TabLock",e[e.FocusLock=8]="FocusLock",e[e.RestoreFocus=16]="RestoreFocus",e[e.All=30]="All",e))(qt||{});function dr(e,t){let n=s.useRef(null),r=fe(n,t),{initialFocus:i,containers:l,features:u=30,...c}=e;Ht()||(u=1);let d=Bt(n);hr({ownerDocument:d},!!(u&16));let v=pr({ownerDocument:d,container:n,initialFocus:i},!!(u&2));vr({ownerDocument:d,container:n,containers:l,previousActiveElement:v},!!(u&8));let w=En(),Z=U(A=>{let f=n.current;f&&(N=>N())(()=>{be(w.current,{[Te.Forwards]:()=>{Me(f,ue.First,{skipElements:[A.relatedTarget]})},[Te.Backwards]:()=>{Me(f,ue.Last,{skipElements:[A.relatedTarget]})}})})}),G=yn(),P=s.useRef(!1),R={ref:r,onKeyDown(A){A.key=="Tab"&&(P.current=!0,G.requestAnimationFrame(()=>{P.current=!1}))},onBlur(A){let f=Yt(l);n.current instanceof HTMLElement&&f.add(n.current);let N=A.relatedTarget;N instanceof HTMLElement&&N.dataset.headlessuiFocusGuard!=="true"&&(Ut(f,N)||(P.current?Me(n.current,be(w.current,{[Te.Forwards]:()=>ue.Next,[Te.Backwards]:()=>ue.Previous})|ue.WrapAround,{relativeTo:A.target}):A.target instanceof HTMLElement&&ne(A.target)))}};return C.createElement(C.Fragment,null,!!(u&4)&&C.createElement(Ct,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:Z,features:kt.Focusable}),me({ourProps:R,theirProps:c,defaultTag:ur,name:"FocusTrap"}),!!(u&4)&&C.createElement(Ct,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:Z,features:kt.Focusable}))}let fr=de(dr),ge=Object.assign(fr,{features:qt});function mr(e=!0){let t=s.useRef(Q.slice());return dt(([n],[r])=>{r===!0&&n===!1&&zt(()=>{t.current.splice(0)}),r===!1&&n===!0&&(t.current=Q.slice())},[e,Q,t]),U(()=>{var n;return(n=t.current.find(r=>r!=null&&r.isConnected))!=null?n:null})}function hr({ownerDocument:e},t){let n=mr(t);dt(()=>{t||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&ne(n())},[t]),jn(()=>{t&&ne(n())})}function pr({ownerDocument:e,container:t,initialFocus:n},r){let i=s.useRef(null),l=Zt();return dt(()=>{if(!r)return;let u=t.current;u&&zt(()=>{if(!l.current)return;let c=e==null?void 0:e.activeElement;if(n!=null&&n.current){if((n==null?void 0:n.current)===c){i.current=c;return}}else if(u.contains(c)){i.current=c;return}n!=null&&n.current?ne(n.current):Me(u,ue.First)===Cn.Error&&console.warn("There are no focusable elements inside the <FocusTrap />"),i.current=e==null?void 0:e.activeElement})},[r]),i}function vr({ownerDocument:e,container:t,containers:n,previousActiveElement:r},i){let l=Zt();It(e==null?void 0:e.defaultView,"focus",u=>{if(!i||!l.current)return;let c=Yt(n);t.current instanceof HTMLElement&&c.add(t.current);let d=r.current;if(!d)return;let v=u.target;v&&v instanceof HTMLElement?Ut(c,v)?(r.current=v,ne(v)):(u.preventDefault(),u.stopPropagation(),ne(d)):ne(r.current)},!0)}function Ut(e,t){for(let n of e)if(n.contains(t))return!0;return!1}function gr(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}const wr=typeof Object.is=="function"?Object.is:gr,{useState:xr,useEffect:br,useLayoutEffect:Er,useDebugValue:yr}=Qe;function jr(e,t,n){const r=t(),[{inst:i},l]=xr({inst:{value:r,getSnapshot:t}});return Er(()=>{i.value=r,i.getSnapshot=t,Ke(i)&&l({inst:i})},[e,r,t]),br(()=>(Ke(i)&&l({inst:i}),e(()=>{Ke(i)&&l({inst:i})})),[e]),yr(r),r}function Ke(e){const t=e.getSnapshot,n=e.value;try{const r=t();return!wr(n,r)}catch{return!0}}function Cr(e,t,n){return t()}const kr=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Rr=!kr,Ar=Rr?Cr:jr,Nr="useSyncExternalStore"in Qe?(e=>e.useSyncExternalStore)(Qe):Ar;function Pr(e){return Nr(e.subscribe,e.getSnapshot,e.getSnapshot)}function Tr(e,t){let n=e(),r=new Set;return{getSnapshot(){return n},subscribe(i){return r.add(i),()=>r.delete(i)},dispatch(i,...l){let u=t[i].call(n,...l);u&&(n=u,r.forEach(c=>c()))}}}function Fr(){let e;return{before({doc:t}){var n;let r=t.documentElement;e=((n=t.defaultView)!=null?n:window).innerWidth-r.clientWidth},after({doc:t,d:n}){let r=t.documentElement,i=r.clientWidth-r.offsetWidth,l=e-i;n.style(r,"paddingRight",`${l}px`)}}}function Mr(){return kn()?{before({doc:e,d:t,meta:n}){function r(i){return n.containers.flatMap(l=>l()).some(l=>l.contains(i))}t.microTask(()=>{var i;if(window.getComputedStyle(e.documentElement).scrollBehavior!=="auto"){let c=_t();c.style(e.documentElement,"scrollBehavior","auto"),t.add(()=>t.microTask(()=>c.dispose()))}let l=(i=window.scrollY)!=null?i:window.pageYOffset,u=null;t.addEventListener(e,"click",c=>{if(c.target instanceof HTMLElement)try{let d=c.target.closest("a");if(!d)return;let{hash:v}=new URL(d.href),w=e.querySelector(v);w&&!r(w)&&(u=w)}catch{}},!0),t.addEventListener(e,"touchstart",c=>{if(c.target instanceof HTMLElement)if(r(c.target)){let d=c.target;for(;d.parentElement&&r(d.parentElement);)d=d.parentElement;t.style(d,"overscrollBehavior","contain")}else t.style(c.target,"touchAction","none")}),t.addEventListener(e,"touchmove",c=>{if(c.target instanceof HTMLElement)if(r(c.target)){let d=c.target;for(;d.parentElement&&d.dataset.headlessuiPortal!==""&&!(d.scrollHeight>d.clientHeight||d.scrollWidth>d.clientWidth);)d=d.parentElement;d.dataset.headlessuiPortal===""&&c.preventDefault()}else c.preventDefault()},{passive:!1}),t.add(()=>{var c;let d=(c=window.scrollY)!=null?c:window.pageYOffset;l!==d&&window.scrollTo(0,l),u&&u.isConnected&&(u.scrollIntoView({block:"nearest"}),u=null)})})}}:{}}function Lr(){return{before({doc:e,d:t}){t.style(e.documentElement,"overflow","hidden")}}}function Sr(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let te=Tr(()=>new Map,{PUSH(e,t){var n;let r=(n=this.get(e))!=null?n:{doc:e,count:0,d:_t(),meta:new Set};return r.count++,r.meta.add(t),this.set(e,r),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t)),this},SCROLL_PREVENT({doc:e,d:t,meta:n}){let r={doc:e,d:t,meta:Sr(n)},i=[Mr(),Fr(),Lr()];i.forEach(({before:l})=>l==null?void 0:l(r)),i.forEach(({after:l})=>l==null?void 0:l(r))},SCROLL_ALLOW({d:e}){e.dispose()},TEARDOWN({doc:e}){this.delete(e)}});te.subscribe(()=>{let e=te.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let r=t.get(n.doc)==="hidden",i=n.count!==0;(i&&!r||!i&&r)&&te.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&te.dispatch("TEARDOWN",n)}});function $r(e,t,n){let r=Pr(te),i=e?r.get(e):void 0,l=i?i.count>0:!1;return ut(()=>{if(!(!e||!t))return te.dispatch("PUSH",e,n),()=>te.dispatch("POP",e,n)},[t,e]),l}let Je=new Map,we=new Map;function Ft(e,t=!0){ut(()=>{var n;if(!t)return;let r=typeof e=="function"?e():e.current;if(!r)return;function i(){var u;if(!r)return;let c=(u=we.get(r))!=null?u:1;if(c===1?we.delete(r):we.set(r,c-1),c!==1)return;let d=Je.get(r);d&&(d["aria-hidden"]===null?r.removeAttribute("aria-hidden"):r.setAttribute("aria-hidden",d["aria-hidden"]),r.inert=d.inert,Je.delete(r))}let l=(n=we.get(r))!=null?n:0;return we.set(r,l+1),l!==0||(Je.set(r,{"aria-hidden":r.getAttribute("aria-hidden"),inert:r.inert}),r.setAttribute("aria-hidden","true"),r.inert=!0),i},[e,t])}let ft=s.createContext(()=>{});ft.displayName="StackContext";var lt=(e=>(e[e.Add=0]="Add",e[e.Remove=1]="Remove",e))(lt||{});function Dr(){return s.useContext(ft)}function Or({children:e,onUpdate:t,type:n,element:r,enabled:i}){let l=Dr(),u=U((...c)=>{t==null||t(...c),l(...c)});return ut(()=>{let c=i===void 0||i===!0;return c&&u(0,n,r),()=>{c&&u(1,n,r)}},[u,n,r,i]),C.createElement(ft.Provider,{value:u},e)}var Hr=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Hr||{}),Br=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(Br||{});let Zr={0(e,t){return e.titleId===t.id?e:{...e,titleId:t.id}}},Se=s.createContext(null);Se.displayName="DialogContext";function ye(e){let t=s.useContext(Se);if(t===null){let n=new Error(`<${e} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,ye),n}return t}function Ir(e,t,n=()=>[document.body]){$r(e,t,r=>{var i;return{containers:[...(i=r.containers)!=null?i:[],n]}})}function zr(e,t){return be(t.type,Zr,e,t)}let _r="div",Vr=Rt.RenderStrategy|Rt.Static;function Wr(e,t){let n=Ee(),{id:r=`headlessui-dialog-${n}`,open:i,onClose:l,initialFocus:u,role:c="dialog",__demoMode:d=!1,...v}=e,[w,Z]=s.useState(0),G=s.useRef(!1);c=function(){return c==="dialog"||c==="alertdialog"?c:(G.current||(G.current=!0,console.warn(`Invalid role [${c}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let P=Rn();i===void 0&&P!==null&&(i=(P&Fe.Open)===Fe.Open);let R=s.useRef(null),A=fe(R,t),f=Bt(R),N=e.hasOwnProperty("open")||P!==null,p=e.hasOwnProperty("onClose");if(!N&&!p)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!N)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!p)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(typeof i!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${i}`);if(typeof l!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${l}`);let j=i?0:1,[re,$e]=s.useReducer(zr,{titleId:null,descriptionId:null,panelRef:s.createRef()}),K=U(()=>l(!1)),je=U(b=>$e({type:0,id:b})),I=Ht()?d?!1:j===0:!1,ae=w>1,Ce=s.useContext(Se)!==null,[De,ke]=An(),he={get current(){var b;return(b=re.panelRef.current)!=null?b:R.current}},{resolveContainers:pe,mainTreeNodeRef:se,MainTreeNode:Re}=Nn({portals:De,defaultContainers:[he]}),Oe=ae?"parent":"leaf",ve=P!==null?(P&Fe.Closing)===Fe.Closing:!1,He=Ce||ve?!1:I,Be=s.useCallback(()=>{var b,O;return(O=Array.from((b=f==null?void 0:f.querySelectorAll("body > *"))!=null?b:[]).find(T=>T.id==="headlessui-portal-root"?!1:T.contains(se.current)&&T instanceof HTMLElement))!=null?O:null},[se]);Ft(Be,He);let Ze=ae?!0:I,Ie=s.useCallback(()=>{var b,O;return(O=Array.from((b=f==null?void 0:f.querySelectorAll("[data-headlessui-portal]"))!=null?b:[]).find(T=>T.contains(se.current)&&T instanceof HTMLElement))!=null?O:null},[se]);Ft(Ie,Ze),Pn(pe,b=>{b.preventDefault(),K()},!(!I||ae));let ze=!(ae||j!==0);It(f==null?void 0:f.defaultView,"keydown",b=>{ze&&(b.defaultPrevented||b.key===Tn.Escape&&(b.preventDefault(),b.stopPropagation(),K()))}),Ir(f,!(ve||j!==0||Ce),pe),s.useEffect(()=>{if(j!==0||!R.current)return;let b=new ResizeObserver(O=>{for(let T of O){let z=T.target.getBoundingClientRect();z.x===0&&z.y===0&&z.width===0&&z.height===0&&K()}});return b.observe(R.current),()=>b.disconnect()},[j,R,K]);let[Ae,_e]=xn(),Ve=s.useMemo(()=>[{dialogState:j,close:K,setTitleId:je},re],[j,re,K,je]),Ne=s.useMemo(()=>({open:j===0}),[j]),Pe={ref:A,id:r,role:c,"aria-modal":j===0?!0:void 0,"aria-labelledby":re.titleId,"aria-describedby":Ae};return C.createElement(Or,{type:"Dialog",enabled:j===0,element:R,onUpdate:U((b,O)=>{O==="Dialog"&&be(b,{[lt.Add]:()=>Z(T=>T+1),[lt.Remove]:()=>Z(T=>T-1)})})},C.createElement(at,{force:!0},C.createElement(st,null,C.createElement(Se.Provider,{value:Ve},C.createElement(st.Group,{target:R},C.createElement(at,{force:!1},C.createElement(_e,{slot:Ne,name:"Dialog.Description"},C.createElement(ge,{initialFocus:u,containers:pe,features:I?be(Oe,{parent:ge.features.RestoreFocus,leaf:ge.features.All&~ge.features.FocusLock}):ge.features.None},C.createElement(ke,null,me({ourProps:Pe,theirProps:v,slot:Ne,defaultTag:_r,features:Vr,visible:j===0,name:"Dialog"}))))))))),C.createElement(Re,null))}let Yr="div";function qr(e,t){let n=Ee(),{id:r=`headlessui-dialog-overlay-${n}`,...i}=e,[{dialogState:l,close:u}]=ye("Dialog.Overlay"),c=fe(t),d=U(w=>{if(w.target===w.currentTarget){if(Fn(w.currentTarget))return w.preventDefault();w.preventDefault(),w.stopPropagation(),u()}}),v=s.useMemo(()=>({open:l===0}),[l]);return me({ourProps:{ref:c,id:r,"aria-hidden":!0,onClick:d},theirProps:i,slot:v,defaultTag:Yr,name:"Dialog.Overlay"})}let Ur="div";function Gr(e,t){let n=Ee(),{id:r=`headlessui-dialog-backdrop-${n}`,...i}=e,[{dialogState:l},u]=ye("Dialog.Backdrop"),c=fe(t);s.useEffect(()=>{if(u.panelRef.current===null)throw new Error("A <Dialog.Backdrop /> component is being used, but a <Dialog.Panel /> component is missing.")},[u.panelRef]);let d=s.useMemo(()=>({open:l===0}),[l]);return C.createElement(at,{force:!0},C.createElement(st,null,me({ourProps:{ref:c,id:r,"aria-hidden":!0},theirProps:i,slot:d,defaultTag:Ur,name:"Dialog.Backdrop"})))}let Kr="div";function Jr(e,t){let n=Ee(),{id:r=`headlessui-dialog-panel-${n}`,...i}=e,[{dialogState:l},u]=ye("Dialog.Panel"),c=fe(t,u.panelRef),d=s.useMemo(()=>({open:l===0}),[l]),v=U(w=>{w.stopPropagation()});return me({ourProps:{ref:c,id:r,onClick:v},theirProps:i,slot:d,defaultTag:Kr,name:"Dialog.Panel"})}let Xr="h2";function Qr(e,t){let n=Ee(),{id:r=`headlessui-dialog-title-${n}`,...i}=e,[{dialogState:l,setTitleId:u}]=ye("Dialog.Title"),c=fe(t);s.useEffect(()=>(u(r),()=>u(null)),[r,u]);let d=s.useMemo(()=>({open:l===0}),[l]);return me({ourProps:{ref:c,id:r},theirProps:i,slot:d,defaultTag:Xr,name:"Dialog.Title"})}let ea=de(Wr),ta=de(Gr),na=de(Jr),ra=de(qr),aa=de(Qr),Gt=Object.assign(ea,{Backdrop:ta,Panel:na,Overlay:ra,Title:aa,Description:wn});function ie({headline:e,type:t,changes:n,className:r}){const[i,l]=s.useState(!1);return o.jsx(At,{onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},className:"relative flex",children:()=>o.jsxs(o.Fragment,{children:[o.jsx("span",{className:_("transition-all flex min-w-[1rem] h-4 text-center mx-0.5 px-1 rounded-full text-[10px] font-black text-neutral-100 cursor-default border border-inherit",t===B.Add&&"bg-success-500 border-success-500",t===B.Remove&&"bg-danger-500 border-danger-500",t===B.Direct&&"bg-secondary-500 border-secondary-500",t===B.Indirect&&"bg-warning-500 border-warning-500",t===B.Metadata&&"bg-neutral-400 border-neutral-400",t===B.Default&&"bg-neutral-600 border-neutral-600",r),children:n.length}),o.jsx(ot,{show:i,as:s.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:o.jsx(At.Panel,{className:"absolute top-6 right-0 z-10 transform flex p-2 bg-theme-lighter shadow-xl focus:ring-2 ring-opacity-5 rounded-lg ",children:o.jsx(jt,{headline:e,type:t,className:"w-full h-full max-w-[50vw] max-h-[40vh] overflow-hidden overflow-y-auto hover:scrollbar scrollbar--vertical",children:o.jsx(jt.Default,{type:t,changes:n})})})})]})})}function sa(){const e=y(i=>i.planOverview),[t,n]=s.useState(e);return s.useEffect(()=>{V(e.isEmpty)&&e.isFinished&&n(new gn(e))},[e]),(V(e.isLatest)||e.isFetching)&&t.hasUpdates?o.jsxs("span",{className:"flex group items-center bg-neutral-5 dark:bg-neutral-20 px-1 py-1 rounded-full",children:[(Le(t.hasChanges)||Le(t.hasBackfills))&&o.jsx(Mt,{className:"mr-2",children:"Changes"}),le(t.added)&&o.jsx(ie,{headline:"Added",type:B.Add,changes:t.added,className:"-mr-2 group-hover:mr-0 z-[5]"}),le(t.direct)&&o.jsx(ie,{headline:"Directly Modified",type:B.Direct,changes:t.direct,className:"-mr-2 group-hover:mr-0 z-[4]"}),le(t.indirect)&&o.jsx(ie,{headline:"Indirectly Modified",type:B.Indirect,changes:t.indirect,className:"-mr-2 group-hover:mr-0 z-[3]"}),le(t.metadata)&&o.jsx(ie,{headline:"Metadata",type:B.Metadata,changes:t.metadata,className:"-mr-2 group-hover:mr-0 z-[2]"}),le(t.removed)&&o.jsx(ie,{headline:"Removed",type:B.Remove,changes:t.removed,className:"-mr-2 group-hover:mr-0 z-[1]"}),le(t.backfills)?o.jsx(ie,{headline:"Backfills",type:B.Default,changes:t.backfills,className:"ml-4 group-hover:ml-2 z-[6]"}):o.jsx("div",{className:"ml-2 group-hover:ml-2 z-[6]"})]}):o.jsx(Mt,{className:"pr-2 pl-0.5 py-1 rounded-full bg-neutral-5 dark:bg-neutral-20 text-neutral-500 dark:text-neutral-300",children:"No Changes"})}function Mt({className:e,children:t}){const n=E(d=>d.environment),r=E(d=>d.addRemoteEnvironments),i=y(d=>d.planAction),{refetch:l}=it(),{refetch:u}=ct(n.name,{planOptions:{skip_tests:!0,include_unmodified:!0}});function c(d){const{environments:v,default_target_environment:w,pinned_environments:Z}=d??{};$t(v)&&r(Object.values(v),w,Z)}return o.jsxs("p",{className:_("flex items-center text-xs text-neutral-600 dark:text-neutral-300 font-bold text-center whitespace-nowrap",e),children:[o.jsx(et,{className:"w-5 h-5 !p-0 !m-0 !ml-0.5 !mr-1 border-none !rounded-full bg-neutral-10 dark:bg-neutral-20",variant:tt.Info,size:St.sm,disabled:i.isProcessing,onClick:d=>{d.stopPropagation(),l().then(({data:v})=>{u(),c(v)})},children:o.jsx($n,{className:"text-neutral-500 dark:text-neutral-300 w-4 h-4"})}),t]})}function Kt({children:e}){return o.jsxs(rn,{className:"inline-block",children:[o.jsx(nt,{className:"w-3 h-3 border border-neutral-10 mr-2"}),o.jsx("span",{className:"inline-block text-xs whitespace-nowrap",children:e})]})}let Xe;function oa(){const e=E(p=>p.modules),t=E(p=>p.environment),n=E(p=>p.models),r=y(p=>p.planAction),i=y(p=>p.planApply),l=y(p=>p.planOverview),u=y(p=>p.planCancel),c=y(p=>p.setPlanApply),d=y(p=>p.setPlanOverview),v=y(p=>p.setPlanCancel),w=y(p=>p.setPlanAction),Z=y(p=>p.resetPlanTrackers),G=y(p=>p.clearPlanApply),{isFetching:P}=an(t.name),{isFetching:R}=sn(),{isFetching:A}=it(),{refetch:f,isFetching:N}=ct(t.name,{planOptions:{skip_tests:!0,include_unmodified:!0}});return s.useEffect(()=>{n.size>0&&V(r.isProcessing)&&V(r.isRunningTask)&&(Z(),G(),f())},[n,t]),s.useEffect(()=>{N&&(l.isFetching=!0,d(l)),P&&(i.isFetching=!0,c(i)),R&&(u.isFetching=!0,v(u))},[N,P,R]),s.useEffect(()=>{clearTimeout(Xe);const p=rt.getPlanAction({planOverview:l,planApply:i,planCancel:u});p===ce.Done&&r.isRunningTask||p===r.value||(Xe=setTimeout(()=>{w(new rt({value:p})),Xe=void 0},on([ce.Running,ce.RunningTask,ce.Cancelling,ce.Applying],p)?0:500))},[l,i,u]),o.jsx("div",{className:"min-h-8 max-h-8 flex w-full items-center justify-end text-neutral-500",children:A?o.jsx(Kt,{children:"Loading Environments..."}):o.jsxs(o.Fragment,{children:[V(e.hasOnlyPlans)&&V(e.hasOnlyPlansAndErrors)&&o.jsx(q,{title:r.isProcessing?r.displayStatus(l):"Plan",to:Y.Plan,icon:r.isProcessing?o.jsx(nt,{variant:tt.Success,className:"w-3 py-1"}):o.jsx(Wt,{className:_("w-5",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100")}),iconActive:r.isProcessing?o.jsx(nt,{variant:tt.Success,className:"w-3 py-1"}):o.jsx(Vt,{className:_("w-5",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100")}),before:o.jsx("p",{className:_("block mx-1 text-xs font-bold whitespace-nowrap",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100"),children:r.isProcessing?r.displayStatus(l):"Plan"}),className:_("px-2 rounded-full py-0.5 mr-1",l.isFailed?"bg-danger-10 dark:bg-danger-500":"bg-success-500"),classActive:_(l.isFailed?"bg-danger-10 dark:bg-danger-500":"bg-success-500")}),o.jsx("div",{className:"flex justify-center items-center min-w-[6rem] max-w-full",children:o.jsx(bn,{className:"border-none mx-2 w-full",size:St.sm,showAddEnvironment:!0,disabled:N||r.isProcessing||t.isInitialProd})}),o.jsx(sa,{})]})})}function la(){const e=Dt();return o.jsxs("div",{className:"flex",children:[o.jsx("button",{onClick:()=>e(-1),className:"inline-block text-neutral-700 dark:text-neutral-300 text-xs hover:bg-neutral-5 dark:hover:bg-neutral-10 px-1 py-1 rounded-full",children:o.jsx(On,{className:"min-w-4 h-4"})}),o.jsx("button",{onClick:()=>e(1),className:"inline-block text-neutral-700 dark:text-neutral-300 text-xs hover:bg-neutral-5 dark:hover:bg-neutral-10 px-1 py-1 rounded-full",children:o.jsx(Mn,{className:"min-w-4 h-4"})})]})}function ia(){const e=E(n=>n.modules),{isFetching:t}=Ot();return o.jsxs("div",{className:_("relative min-w-[10rem] px-2 min-h-[2rem] max-h-[2rem] w-full flex items-center",e.showHistoryNavigation?"justify-between":"justify-end",t&&"overflow-hidden"),children:[e.showHistoryNavigation&&o.jsx(la,{}),t&&o.jsx("div",{className:"absolute w-full h-full flex justify-center items-center z-10 bg-transparent-20 backdrop-blur-lg",children:o.jsx(Kt,{children:"Loading Models..."})}),e.hasPlans&&o.jsx(oa,{}),e.hasErrors&&o.jsx(vn,{})]})}function ca({show:e,children:t,afterLeave:n,onClose:r=()=>{}}){return o.jsx(ot,{appear:!0,show:e,as:s.Fragment,afterLeave:n,children:o.jsxs(Gt,{as:"div",className:"relative z-50",onClose:r,children:[o.jsx("div",{className:"fixed inset-0 bg-overlay opacity-90"}),o.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:o.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:o.jsx(ot.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:t})})})]})})}function D({show:e,children:t,onClose:n,afterLeave:r}){return o.jsx(ca,{show:e,onClose:n,afterLeave:r,children:o.jsx(Gt.Panel,{className:"min-w-[20rem] max-w-[50rem] transform rounded-xl bg-theme text-left align-middle shadow-xl transition-all overflow-hidden",children:t})})}function ua({children:e}){return o.jsx("div",{className:"py-4 px-5 m-2",children:e})}function da({children:e}){return o.jsx("h2",{className:"font-bold text-xl mb-2",children:e})}function fa({children:e}){return o.jsx("h4",{className:"font-bold",children:e})}function ma({children:e}){return o.jsx("p",{className:"text-sm",children:e})}function ha({children:e}){return o.jsx("div",{className:"flex justify-end items-center py-3 px-3",children:e})}function pa({details:e}){return o.jsx("ul",{className:"my-2 p-4 bg-warning-10 rounded-md max-h-[20vh] overflow-y-auto hover:scrollbar scrollbar--vertical",children:e.map(t=>o.jsx("li",{className:"text-sm",children:t},t))})}D.Headline=da;D.Tagline=fa;D.Description=ma;D.Actions=ha;D.Main=ua;D.Details=pa;const va=2e4,ga=3e3;class wa{constructor(t,n){oe(this,"channels",new Map);oe(this,"eventSource");oe(this,"timerId");oe(this,"source");oe(this,"delay",va);this.source=t,this.delay=n??this.delay,this.setEventSource()}listen(t){t.addEventListener("error",n=>{this.reconnect(ga)}),t.addEventListener("ping",n=>{this.reconnect(this.delay)})}cleanup(){var t;this.channels.forEach((n,r)=>{var i;$(n)&&((i=this.eventSource)==null||i.removeEventListener(r,n))}),(t=this.eventSource)==null||t.close(),this.eventSource=void 0}resubscribe(){this.channels.forEach((t,n)=>{var r;$(t)&&((r=this.eventSource)==null||r.addEventListener(n,t))})}reconnect(t){clearTimeout(this.timerId),this.timerId=setTimeout(()=>{console.log(`Reconnecting Event Source ${this.source}`),this.cleanup(),this.setEventSource(),this.resubscribe()},t)}getEventSource(){return new EventSource(this.source,{withCredentials:!0})}setEventSource(){this.eventSource=this.getEventSource(),this.listen(this.eventSource)}addChannel(t,n){var i;const r=this.getChannelHandler(t,n);(i=this.eventSource)==null||i.addEventListener(t,r),this.channels.set(t,r)}removeChannel(t){var r;const n=this.getChannel(t);$(n)&&((r=this.eventSource)==null||r.removeEventListener(t,n),this.channels.delete(t))}hasChannel(t){return $(this.getChannel(t))}getChannel(t){return this.channels.get(t)}getChannelHandler(t,n){return r=>{if(this.reconnect(this.delay),!(S(t)||S(n)||S(r.data)))try{n(JSON.parse(r.data))}catch(i){console.warn(i)}}}}let xe;function xa(){return S(xe)&&(xe=new wa(ln("/api/events"))),(e,t)=>({subscribe(){$(e)&&$(t)&&V(xe.hasChannel(e))&&xe.addChannel(e,t)},unsubscribe(){xe.removeChannel(e)}})}function _a({content:e}){const t=cn(),n=Dt(),{removeError:r,addError:i}=Lt(),l=E(a=>a.modules),u=E(a=>a.environment),c=E(a=>a.environments),d=E(a=>a.showConfirmation),v=E(a=>a.confirmations),w=E(a=>a.setShowConfirmation),Z=E(a=>a.removeConfirmation),G=E(a=>a.setModels),P=E(a=>a.addRemoteEnvironments),R=E(a=>a.addLocalEnvironment),A=E(a=>a.setEnvironment);let f;V(l.hasOnlyDataCatalog)&&(f=xa());const N=y(a=>a.planApply),p=y(a=>a.planOverview),j=y(a=>a.planCancel),re=y(a=>a.setPlanApply),$e=y(a=>a.setPlanOverview),K=y(a=>a.setPlanCancel),je=y(a=>a.setPlanAction),I=X(a=>a.files),ae=X(a=>a.selectedFile),Ce=X(a=>a.setProject),De=X(a=>a.setFiles),ke=X(a=>a.refreshFiles),he=X(a=>a.findArtifactByPath),pe=X(a=>a.setTests),se=X(a=>a.setActiveRange),Re=ee(a=>a.storedTabs),Oe=ee(a=>a.storedTabId),ve=ee(a=>a.selectTab),He=ee(a=>a.createTab),Be=ee(a=>a.addTabs),Ze=ee(a=>a.closeTab),Ie=ee(a=>a.inTabs),mt=E(a=>a.setVersion),{refetch:ze,cancel:ht}=un(),{refetch:Ae,cancel:_e}=Ot(),{refetch:Ve,cancel:Ne}=dn(),{refetch:Pe,cancel:b}=it(),{refetch:O,cancel:T}=ct(u.name,{planOptions:{skip_tests:!0,include_unmodified:!0}}),z=s.useCallback(function(m){const x=Array.from(c).find(g=>g.name===m);S(x)?R(m):A(x)},[c]),pt=s.useCallback(function(m){p.update(m),m.environment!==u.name&&z(m.environment),$e(p)},[z,u]),vt=s.useCallback(function(m){var g,L;N.update(m,p),m.environment!==u.name&&z(m.environment),re(N);const x=Le((g=m.meta)==null?void 0:g.done)&&((L=m.meta)==null?void 0:L.status)!==qe.init;j.isFinished||j.isRunning||V(x)||Pe().then(({data:k})=>{O(),bt(k)})},[j,p,z,u]),gt=s.useCallback(function(m){var x,g;j.update(m),m.environment!==u.name&&z(m.environment),K(j),!(fn((x=m.meta)==null?void 0:x.done)||((g=m.meta)==null?void 0:g.status)===qe.init)&&O()},[z,u]),wt=s.useCallback(function({changes:m,directories:x}){var g,L;m.sort(k=>k.change===Ge.Deleted?-1:1),m.forEach(({change:k,path:J,file:F})=>{var M,W;if(k===Ge.Modified){const H=I.get(J);if(S(H)||S(F))return;H.update(F)}if(k===Ge.Deleted){const H=he(J)??I.get(J);if(S(H))return;H instanceof Ue&&((M=H.parent)==null||M.removeDirectory(H)),H instanceof Nt&&((W=H.parent)==null||W.removeFile(H),Ie(H)&&Ze(H))}});for(const k in x){const J=x[k],F=he(k);S(F)||((g=J.directories)==null||g.forEach(M=>{const W=he(M.path);S(W)&&F.addDirectory(new Ue(M,F))}),(L=J.files)==null||L.forEach(M=>{const W=I.get(M.path);S(W)&&F.addFile(new Nt(M,F))}),F.directories.sort((M,W)=>M.name>W.name?1:-1),F.files.sort((M,W)=>M.name>W.name?1:-1))}ke(),se(),Ae().then(({data:k})=>We(k))},[I]),xt=s.useCallback(function(m){const x=I.get(m.path);$(x)&&(x.isFormatted=m.status===qe.success,ke())},[I]),Jt=s.useCallback(function(m){if(mn(Re))return;const x=Re.map(({id:L,content:k})=>{const J=m.find(M=>M.id===L)??Ln(L),F=He(J);return F.file.content=k??F.file.content??"",F}),g=x.find(L=>L.file.id===Oe);Be(x),$(g)&&S(ae)&&ve(g)},[ve]);s.useEffect(()=>{ze().then(({data:g})=>{mt(g==null?void 0:g.version),Le(g==null?void 0:g.has_running_task)&&je(new rt({value:ce.RunningTask}))}),Ae().then(({data:g})=>We(g));const a=f==null?void 0:f("errors",Xt),m=f==null?void 0:f("tests",Qt),x=f==null?void 0:f("models",We);return x==null||x.subscribe(),l.hasPlans&&(m==null||m.subscribe(),Pe().then(({data:g})=>bt(g))),l.hasErrors&&(a==null||a.subscribe()),l.hasFiles&&Ve().then(({data:g})=>{if(S(g))return;const L=new Ue(g),k=L.allFiles;Jt(k),De(k),Ce(L)}),()=>{ht(),_e(),x==null||x.unsubscribe(),l.hasPlans&&(b(),T()),l.hasErrors&&(a==null||a.unsubscribe()),l.hasTests&&(m==null||m.unsubscribe()),l.hasFiles&&Ne()}},[l]),s.useEffect(()=>{const a=f==null?void 0:f("plan-apply",vt);return l.hasPlans&&(a==null||a.subscribe()),()=>{l.hasPlans&&(a==null||a.unsubscribe())}},[vt,l]),s.useEffect(()=>{const a=f==null?void 0:f("plan-overview",pt);return l.hasPlans&&(a==null||a.subscribe()),()=>{l.hasPlans&&(a==null||a.unsubscribe())}},[pt,l]),s.useEffect(()=>{const a=f==null?void 0:f("plan-cancel",gt);return l.hasPlans&&(a==null||a.subscribe()),()=>{l.hasPlans&&(a==null||a.unsubscribe())}},[gt,l]),s.useEffect(()=>{const a=f==null?void 0:f("file",wt);return a==null||a.subscribe(),()=>{a==null||a.unsubscribe()}},[wt]),s.useEffect(()=>{const a=f==null?void 0:f("format-file",xt);return a==null||a.subscribe(),()=>{a==null||a.unsubscribe()}},[xt]),s.useEffect(()=>{(V(l.isEmpty)&&t.pathname===Y.Home||t.pathname==="")&&n(l.defaultNavigationRoute(),{replace:!0})},[t,l]),s.useEffect(()=>{w(v.length>0)},[v]);function We(a){$(a)&&(r(Et.Models),G(a))}function Xt(a){i(Et.General,a)}function Qt(a){pe(a)}function bt(a){const{environments:m,default_target_environment:x,pinned_environments:g}=a??{};$t(m)&&P(Object.values(m),x,g)}function Ye(a){var m;(m=a==null?void 0:a.cancel)==null||m.call(a),w(!1)}const h=v[0];return o.jsxs(hn.Page,{layout:"horizontal",children:[l.showModuleNavigation&&o.jsxs(o.Fragment,{children:[o.jsx(ir,{className:"overflow-hidden py-1 px-2 flex flex-col items-center"}),o.jsx(yt,{orientation:"vertical"})]}),o.jsxs("div",{className:"flex flex-col overflow-hidden w-full h-full",children:[l.showNavigation&&o.jsxs(o.Fragment,{children:[o.jsx(ia,{}),o.jsx(yt,{})]}),e??o.jsx(pn,{}),o.jsxs(D,{show:d,onClose:()=>{Ye(h)},afterLeave:()=>{Z()},onKeyDown:a=>{a.key==="Escape"&&Ye(h)},children:[o.jsxs(D.Main,{children:[$(h==null?void 0:h.headline)&&o.jsx(D.Headline,{children:h==null?void 0:h.headline}),$(h==null?void 0:h.tagline)&&o.jsx(D.Tagline,{children:h==null?void 0:h.tagline}),$(h==null?void 0:h.details)&&o.jsx(D.Details,{details:h==null?void 0:h.details}),$(h==null?void 0:h.description)&&o.jsx(D.Description,{children:h==null?void 0:h.description}),h==null?void 0:h.children]}),o.jsxs(D.Actions,{children:[o.jsx(et,{className:"font-bold",size:"md",variant:"danger",onClick:a=>{var m;a.stopPropagation(),(m=h==null?void 0:h.action)==null||m.call(h),w(!1)},children:(h==null?void 0:h.yesText)??"Confirm"}),o.jsx(et,{size:"md",variant:"alternative",onClick:a=>{a.stopPropagation(),Ye(h)},children:(h==null?void 0:h.noText)??"Cancel"})]})]})]})]})}export{_a as default};
