import"../chunks/CWj6FrbW.js";import{p as Ge,a as n,b as z,s as p,f as X,c as He,d as f,e as t,g as e,u as L,r as _,h as $}from"../chunks/DJ4-OfXg.js";import{s as we}from"../chunks/DpcWkFIJ.js";import{i as j}from"../chunks/DU3kBxd7.js";import{e as Se,i as ke}from"../chunks/DiyBIa6G.js";import{t as x,a as b}from"../chunks/BBucZf18.js";import{d as Ie}from"../chunks/Bcqz6BHu.js";import{S as Je,d as Ke,c as Te}from"../chunks/pVhPhZzS.js";import{A as ne}from"../chunks/HX9qiWDz.js";import{f as Me,B as Qe}from"../chunks/BSJu0SI5.js";import{R as ce}from"../chunks/Cjb3PMTS.js";import{g as Z}from"../chunks/CqS7hfz2.js";var Ue=(ee,U,B)=>{U(),B()},We=x("<option> </option>"),Xe=x("<h3>Subvariable</h3> <!>",1),Ze=(ee,U,B)=>{U(),B()},$e=x("<option> </option>"),et=x('<h3>Carrier</h3> <select class="form-select"></select>',1),tt=x('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Variable Selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show"><div class="accordion-body"><h3>Variable</h3> <select class="form-select"></select> <!> <!></div></div></div>'),rt=x('<div class="col-6"><h3>Aggregation</h3> <!></div>'),at=x("<h3>Technology</h3> <!>",1),ot=x("<h3>Node</h3> <!>",1),st=x('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Data Selection</button></h2> <div id="collapseThree" class="accordion-collapse collapse show"><div class="accordion-body"><div class="row"><!> <div class="col-6"><h3>Normalisation</h3> <!></div></div> <!> <h3>Year</h3> <!></div></div></div>'),it=x('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),lt=x("<div></div>"),nt=x("<div></div>"),ct=x('<div class="text-center">No technologies with this selection.</div>'),dt=x('<div class="text-center">No carriers with this selection.</div>'),_t=x('<div class="text-center">No data with this selection.</div>'),vt=x('<h2>Production</h2> <div class="z-1 position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body"><!></div></div></div> <!> <!></div></div></div> <div class="mt-4"><!></div>',1);function Tt(ee,U){Ge(U,!0);let B=n(null),y=n(z([])),te=n(z([])),re=n(z([])),J=n(z([])),W=n(z([])),K=z({conversion:["input","output"],storage:["charge","discharge"],transport:[],import_export:["import","export"]});const Ae=["technology","node"];let Y=n(z([])),de=n(z({})),o=n(null),i=n("conversion"),E=n("input"),w=n(null),A=n(z([])),D=n(z([])),P=n(z([])),M=n(z([]));const Oe=["not_normalized","normalized"];let ae=n("not_normalized"),O=n(!1),k=n(!1),_e=n("plot"),q=n("node"),ve=n(z([])),ze=L(()=>({type:"bar",data:{datasets:e(Y),labels:e(ve)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${e(i)} [${e(w)?e(de)[e(w)]:""}]`}}}}}));function oe(){Ne().then(()=>{je(),pe(),Be(),G()})}function se(){t(M,e(W),!0),t(P,e(J),!0),t(D,e(A),!0)}function ue(){switch(e(i)){case"conversion":return"flow_conversion_"+e(E);case"storage":return"flow_storage_"+e(E);case"transport":return"flow_transport";case"import_export":return"flow_"+e(E);default:return null}}async function Ne(){var c,v;t(k,!0),t(B,null);let r=ue();if(r===null||e(o)===null){t(k,!1);return}r=Z(r,(c=e(o))==null?void 0:c.version);let s=await Ke(e(o).solution_name,r,e(o).scenario_name,e(o).detail.system.reference_year,e(o).detail.system.interval_between_years);s.data!==null&&(t(B,s.data,!0),(v=s.unit)!=null&&v.data&&t(de,Object.fromEntries(s.unit.data.map(a=>[a.carrier,a[0]||a.units])),!0),t(k,!1))}function je(){var s,c,v;if(e(B)==null||e(o)==null){t(y,[],!0);return}switch(t(Y,[],!0),e(i)){case Z("import_export",(s=e(o))==null?void 0:s.version):e(E)=="import"?t(y,e(o).detail.carriers_import,!0):t(y,e(o).detail.carriers_export,!0);break;case Z("conversion",(c=e(o))==null?void 0:c.version):let a;e(E)=="input"?a=e(o).detail.carriers_input:a=e(o).detail.carriers_output,t(y,Array.from(new Set(Object.values(a).flat())),!0);break;default:t(y,e(o).detail.system.set_carriers,!0)}let r=null;e(i)=="import_export"?r=Array.from(new Set(e(B).data.map(a=>a.carrier))):e(i)!=Z("conversion",(v=e(o))==null?void 0:v.version)&&(r=Array.from(new Set(e(B).data.map(a=>{var l;return(l=e(o))==null?void 0:l.detail.reference_carrier[a.technology]})))),r!=null&&t(y,e(y).filter(a=>r.includes(a)),!0),(e(y).length>=1&&!e(w)||!e(y).includes(e(w)))&&t(w,e(y)[0],!0),se()}function pe(){var r,s,c;if(t(Y,[],!0),e(i)!=null&&e(w)!=null){switch(t(A,((r=e(o))==null?void 0:r.detail.system.set_technologies.slice())??[],!0),e(i)){case"conversion":t(A,[],!0);let v=e(o).detail.carriers_input;e(E)=="output"&&(v=e(o).detail.carriers_output);for(const a in v)v[a].includes(e(w))&&e(A).push(a);break;case"storage":t(A,((s=e(o))==null?void 0:s.detail.system.set_storage_technologies.filter(a=>{var l;return((l=e(o))==null?void 0:l.detail.reference_carrier[a])==e(w)}))??[],!0);break;case"transport":t(A,((c=e(o))==null?void 0:c.detail.system.set_transport_technologies.filter(a=>{var l;return((l=e(o))==null?void 0:l.detail.reference_carrier[a])==e(w)}))??[],!0);break;case"import_export":t(A,[],!0);break}e(A).length==1&&t(D,[e(A)[0]],!0),se()}}function Be(){e(i)=="transport"?t(J,e(re),!0):t(J,e(te),!0),t(P,e(J),!0),se()}function Ce(){t(Y,[],!0),e(i)!=null&&(K[e(i)]!=null&&t(E,K[e(i)][0],!0),e(i)=="import_export"&&t(q,"technology"))}function G(){var F,R;if(e(i)=="import_export"&&t(q,"node"),e(q)=="technology"?t(P,e(J),!0):t(D,e(A),!0),e(P).length==0||e(M).length==0||e(D).length==0&&e(i)!="import_export"||!e(B)){t(Y,[],!0);return}let r={},s={},c="node";e(i)=="transport"&&(c="edge"),e(i)=="import_export"?(r[c]=e(P),s.carrier=[e(w)]):e(q)=="technology"?(r[c]=e(P),s.technology=e(D)):(r.technology=e(D),s[c]=e(P));let v=e(W).filter(h=>!e(M).includes(h)),a=e(B).data.filter(h=>h.carrier===void 0||h.carrier==e(w));t(Y,Me(a,r,s,v,e(ae)=="normalized"),!0),t(ve,e(M).map(h=>h.toString()),!0);let l=e(o).solution_name.split(".");t(_e,[l[(l==null?void 0:l.length)-1],(F=e(o))==null?void 0:F.scenario_name,Z(ue(),(R=e(o))==null?void 0:R.version),e(w)].join("_"),!0)}var ge=vt(),ie=p(X(ge),2),fe=f(ie),he=f(fe),le=f(he),me=p(f(le),2),be=f(me),Ee=f(be);const Pe=L(()=>!e(O)&&!e(k));Je(Ee,{solution_selected:oe,get enabled(){return e(Pe)},get carriers(){return e(y)},set carriers(r){t(y,r,!0)},get nodes(){return e(te)},set nodes(r){t(te,r,!0)},get years(){return e(W)},set years(r){t(W,r,!0)},get selected_solution(){return e(o)},set selected_solution(r){t(o,r,!0)},get edges(){return e(re)},set edges(r){t(re,r,!0)},get loading(){return e(O)},set loading(r){t(O,r,!0)}}),_(be),_(me),_(le);var xe=p(le,2);{var Re=r=>{var s=tt(),c=p(f(s),2),v=f(c),a=p(f(v),2);a.__change=[Ue,Ce,oe],Se(a,21,()=>Object.entries(K),ke,(m,N)=>{let S=()=>e(N)[0];var d=We(),T={},C=f(d,!0);_(d),$(()=>{T!==(T=S())&&(d.value=(d.__value=S())??""),we(C,S())}),b(m,d)}),_(a);var l=p(a,2);{var F=m=>{var N=Xe(),S=p(X(N),2);const d=L(()=>!e(O)&&!e(k));ce(S,{get options(){return K[e(i)]},selection_changed:oe,get enabled(){return e(d)},get selected_option(){return e(E)},set selected_option(T){t(E,T,!0)}}),b(m,N)};j(l,m=>{K&&e(i)&&K[e(i)].length>0&&m(F)})}var R=p(l,2);{var h=m=>{var N=et(),S=p(X(N),2);S.__change=[Ze,pe,G],Se(S,21,()=>e(y),ke,(d,T)=>{var C=$e(),u={},g=f(C,!0);_(C),$(()=>{u!==(u=e(T))&&(C.value=(C.__value=e(T))??""),we(g,e(T))}),b(d,C)}),_(S),$(()=>S.disabled=e(O)||e(k)),Te(S,()=>e(w),d=>t(w,d)),b(m,N)};j(R,m=>{e(i)!=null&&e(y).length>0&&m(h)})}_(v),_(c),_(s),$(()=>a.disabled=e(O)||e(k)),Te(a,()=>e(i),m=>t(i,m)),b(r,s)};j(xe,r=>{!e(O)&&e(o)&&r(Re)})}var Ve=p(xe,2);{var Ye=r=>{var s=st(),c=p(f(s),2),v=f(c),a=f(v),l=f(a);{var F=u=>{var g=rt(),V=p(f(g),2);const H=L(()=>!e(O)&&!e(k));ce(V,{options:Ae,selection_changed:G,get enabled(){return e(H)},get selected_option(){return e(q)},set selected_option(I){t(q,I,!0)}}),_(g),b(u,g)};j(l,u=>{e(i)!="import_export"&&u(F)})}var R=p(l,2),h=p(f(R),2);const m=L(()=>!e(O)&&!e(k));ce(h,{options:Oe,selection_changed:G,get enabled(){return e(m)},get selected_option(){return e(ae)},set selected_option(u){t(ae,u,!0)}}),_(R),_(a);var N=p(a,2);{var S=u=>{var g=at(),V=p(X(g),2);const H=L(()=>!e(O)&&!e(k));ne(V,{get elements(){return e(A)},get enabled(){return e(H)},selection_changed:G,get selected_elements(){return e(D)},set selected_elements(I){t(D,I,!0)}}),b(u,g)},d=u=>{var g=ot(),V=p(X(g),2);const H=L(()=>!e(O)&&!e(k));ne(V,{get elements(){return e(J)},get enabled(){return e(H)},selection_changed:G,get selected_elements(){return e(P)},set selected_elements(I){t(P,I,!0)}}),b(u,g)};j(N,u=>{e(q)=="technology"?u(S):u(d,!1)})}var T=p(N,4);const C=L(()=>!e(O)&&!e(k));ne(T,{get elements(){return e(W)},get enabled(){return e(C)},selection_changed:G,get selected_elements(){return e(M)},set selected_elements(u){t(M,u,!0)}}),_(v),_(c),_(s),b(r,s)};j(Ve,r=>{!e(k)&&e(w)&&(e(A).length>0||e(i)=="import_export")&&r(Ye)})}_(he),_(fe),_(ie);var ye=p(ie,2),De=f(ye);{var Fe=r=>{var s=it();b(r,s)},Le=(r,s)=>{{var c=a=>{var l=lt();b(a,l)},v=(a,l)=>{{var F=h=>{var m=nt();b(h,m)},R=(h,m)=>{{var N=d=>{var T=ct();b(d,T)},S=(d,T)=>{{var C=g=>{var V=dt();b(g,V)},u=(g,V)=>{{var H=Q=>{var qe=_t();b(Q,qe)},I=Q=>{Qe(Q,{get config(){return e(ze)},get plot_name(){return e(_e)}})};j(g,Q=>{e(Y).length==0?Q(H):Q(I,!1)},V)}};j(d,g=>{e(y).length==0?g(C):g(u,!1)},T)}};j(h,d=>{e(A).length==0&&e(i)!="import_export"?d(N):d(S,!1)},m)}};j(a,h=>{e(Y)==null?h(F):h(R,!1)},l)}};j(r,a=>{e(o)==null?a(c):a(v,!1)},s)}};j(De,r=>{e(O)||e(k)?r(Fe):r(Le,!1)})}_(ye),b(ee,ge),He()}Ie(["change"]);export{Tt as component};
