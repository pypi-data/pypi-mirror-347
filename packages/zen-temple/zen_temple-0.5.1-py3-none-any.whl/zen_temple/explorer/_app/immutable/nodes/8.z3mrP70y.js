import"../chunks/CWj6FrbW.js";import{p as Ue,a as s,b as C,s as n,f as J,c as We,d,e as t,g as e,u as le,t as Xe,r as i,h as K}from"../chunks/DJ4-OfXg.js";import{s as re}from"../chunks/DpcWkFIJ.js";import{i as T}from"../chunks/DU3kBxd7.js";import{e as ye,i as me}from"../chunks/DiyBIa6G.js";import{t as h,a as p}from"../chunks/BBucZf18.js";import{d as Ze}from"../chunks/Bcqz6BHu.js";import{S as $e,d as et,c as be}from"../chunks/pVhPhZzS.js";import{A as xe}from"../chunks/HX9qiWDz.js";import{R as we}from"../chunks/Cjb3PMTS.js";import{f as tt,B as at}from"../chunks/BSJu0SI5.js";async function ot(se,M,Q,y,O,ie,N,A){t(M,null),t(Q,[],!0),await y(),O(),ie(),N(),A()}function lt(se,M,Q,y,O){M(),Q(),y(),O()}var rt=h("<option> </option>"),st=h("<option> </option>"),it=h('<h3>Technology Type</h3> <select class="form-select"></select> <!>',1),nt=h("<option> </option>"),ct=h('<h3>Carrier</h3> <select class="form-select"><!> </select>',1),dt=h("<h3>Technology</h3> <!>",1),_t=h("<h3>Node</h3> <!>",1),vt=h('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Data Selection</button></h2> <div id="collapseThree" class="accordion-collapse collapse show"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Aggregation</h3> <!></div> <div class="col-6"><h3>Normalisation</h3> <!></div></div> <!> <h3>Year</h3> <!></div></div></div>'),ut=h('<div class="accordion-item variable-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Variable Selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show"><div class="accordion-body"><h3>Variable</h3> <select class="form-select"></select> <!> <!></div></div></div> <!>',1),gt=h('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),pt=h('<div class="text-center">No technologies with this selection.</div>'),ht=h('<div class="text-center">No carriers with this selection.</div>'),ft=h('<div class="text-center">No solution selected.</div>'),yt=h('<div class="text-center">No data with this selection.</div>'),mt=h('<div class="text-center">No locations with this selection.</div>'),bt=h('<div class="text-center">No data with this selection.</div>'),xt=h('<h2>Capacity</h2> <div class="z-1 position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!></div>',1);function Bt(se,M){Ue(M,!0);let Q=["conversion","storage","transport"],y=s(null),O=s(null),ie=["capacity","capacity_addition"],N=s(C([])),A=s(C([])),U=s(C([])),j=s(C([])),v=s(null),De=C(["technology","node"]);const Fe=["not_normalized","normalized"],Te=["energy","power"];let D=s("capacity"),G=s(null),Z=s("energy"),H=s("technology"),S=s("conversion"),F=s(C([])),I=s(C([])),L=s(C([])),$=s("not_normalized"),B=s(!1),R=s(!1),Ne=s(""),ne=s(C([])),Se=s(C([])),ze=s(C({})),Le=le(()=>{const a=e(S)=="storage"?e(Z):"power";return e(ze)[e(j)[0]+"_"+a]||""}),Pe=le(()=>({type:"bar",data:{datasets:e(ne),labels:e(Se)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`${e(D)} [${e(Le)}]`}}}}}));function ee(){t($,"not_normalized"),t(L,e(A),!0),t(F,e(j),!0),t(I,e(U),!0),t(H,"node")}async function ke(){var l;if(t(R,!0),t(y,null),await Xe(),e(D)===null||e(v)===null){t(R,!1);return}const a=await et(e(v).solution_name,e(D),e(v).scenario_name,e(v).detail.system.reference_year,e(v).detail.system.interval_between_years);t(y,a.data,!0),(l=a.unit)!=null&&l.data&&t(ze,Object.fromEntries(a.unit.data.map(c=>[c.technology+"_"+c.capacity_type,c[0]||c.units])),!0),t(R,!1)}async function qe(){t(y,null),t(G,null),t(O,null),await ke(),Oe(),ae(),te(),ee(),Y()}function Ee(){Oe(),ae(),te(),ee(),Y()}function Oe(){if(t(N,[],!0),e(y)===null||e(S)===null)return;let a=Ae();e(y).data.forEach(l=>{let c=l.technology,z=e(v).detail.reference_carrier[c];!e(N).includes(z)&&a.includes(l.technology)&&e(N).push(z)}),e(N).length>0&&t(G,e(N)[0],!0)}function te(){e(y)!==null&&(t(A,[],!0),e(y).data.forEach(a=>{let l=a.technology,c=e(v).detail.reference_carrier[l];e(j).includes(a.technology)&&!e(A).includes(a.location)&&e(A).push(a.location),!e(N).includes(c)&&e(j).includes(a.technology)&&e(N).push(c)}),t(L,e(A),!0))}function Ae(){if(!e(v)||!e(S))return[];switch(e(S)){case"conversion":return e(v).detail.system.set_conversion_technologies;case"storage":return e(v).detail.system.set_storage_technologies;case"transport":return e(v).detail.system.set_transport_technologies}return[]}function ae(){if(e(S)===null)return;let a=Ae();t(j,a.filter(l=>{var c;return((c=e(v))==null?void 0:c.detail.reference_carrier[l])==e(G)}),!0),t(F,e(j),!0)}function Y(){var k;if(e(H)=="technology"?t(L,e(A),!0):t(F,e(j),!0),e(D)==null||e(L).length==0||e(I).length==0||e(F).length==0||e(y)===null){t(O,null);return}let a={},l={};e(H)=="technology"?(a.location=e(L),l.technology=e(F)):(a.technology=e(F),l.location=e(L)),e(S)=="storage"?l.capacity_type=[e(Z)]:l.capacity_type=Te;let c=e(U).filter(m=>!e(I).includes(m));t(O,tt(e(y).data,a,l,c,e($)=="normalized"),!0),t(ne,e(O),!0),t(Se,e(I).map(m=>m.toString()),!0);let z=e(v).solution_name.split(".");t(Ne,[z[(z==null?void 0:z.length)-1],(k=e(v))==null?void 0:k.scenario_name,e(D),e(S),e(G)].join("_"),!0)}var Ce=xt(),ce=n(J(Ce),2),je=d(ce),Be=d(je),de=d(Be),Re=n(d(de),2),Ve=d(Re),Ge=d(Ve);const He=le(()=>!e(R)&&!e(B));$e(Ge,{solution_selected:qe,get enabled(){return e(He)},get years(){return e(U)},set years(a){t(U,a,!0)},get selected_solution(){return e(v)},set selected_solution(a){t(v,a,!0)},get loading(){return e(B)},set loading(a){t(B,a,!0)}}),i(Ve),i(Re),i(de);var Ie=n(de,2);{var Je=a=>{var l=ut(),c=J(l),z=n(d(c),2),k=d(z),m=n(d(k),2);m.__change=[ot,O,ne,ke,ae,te,ee,Y],ye(m,21,()=>ie,me,(r,g)=>{var o=rt(),E={},f=d(o,!0);i(o),K(()=>{E!==(E=e(g))&&(o.value=(o.__value=e(g))??""),re(f,e(g))}),p(r,o)}),i(m);var oe=n(m,2);{var _e=r=>{var g=it(),o=n(J(g),2);o.__change=Ee,ye(o,21,()=>Q,me,(_,w)=>{var u=st(),b={},V=d(u,!0);i(u),K(()=>{b!==(b=e(w))&&(u.value=(u.__value=e(w))??""),re(V,e(w))}),p(_,u)}),i(o);var E=n(o,2);{var f=_=>{const w=le(()=>!e(R)&&!e(B));we(_,{options:Te,selection_changed:Ee,get enabled(){return e(w)},get selected_option(){return e(Z)},set selected_option(u){t(Z,u,!0)}})};T(E,_=>{e(S)=="storage"&&_(f)})}K(()=>o.disabled=e(R)||e(B)),be(o,()=>e(S),_=>t(S,_)),p(r,g)};T(oe,r=>{e(D)!=null&&r(_e)})}var P=n(oe,2);{var W=r=>{var g=ct(),o=n(J(g),2);o.__change=[lt,ae,te,ee,Y];var E=d(o);ye(E,17,()=>e(N),me,(_,w)=>{var u=nt(),b={},V=d(u,!0);i(u),K(()=>{b!==(b=e(w))&&(u.value=(u.__value=e(w))??""),re(V,e(w))}),p(_,u)});var f=n(E);i(o),K(()=>{o.disabled=e(R)||e(B),re(f,` disabled=${(e(R)||e(B))??""}`)}),be(o,()=>e(G),_=>t(G,_)),p(r,g)};T(P,r=>{e(S)!=null&&e(N).length>0&&r(W)})}i(k),i(z),i(c);var ve=n(c,2);{var ue=r=>{var g=vt(),o=n(d(g),2),E=d(o),f=d(E),_=d(f),w=n(d(_),2);we(w,{get options(){return De},selection_changed:Y,get selected_option(){return e(H)},set selected_option(x){t(H,x,!0)}}),i(_);var u=n(_,2),b=n(d(u),2);we(b,{options:Fe,selection_changed:Y,get selected_option(){return e($)},set selected_option(x){t($,x,!0)}}),i(u),i(f);var V=n(f,2);{var ge=x=>{var X=dt(),he=n(J(X),2);xe(he,{get elements(){return e(j)},selection_changed:Y,get selected_elements(){return e(F)},set selected_elements(fe){t(F,fe,!0)}}),p(x,X)},pe=x=>{var X=_t(),he=n(J(X),2);xe(he,{get elements(){return e(A)},selection_changed:Y,get selected_elements(){return e(L)},set selected_elements(fe){t(L,fe,!0)}}),p(x,X)};T(V,x=>{e(H)=="technology"?x(ge):x(pe,!1)})}var q=n(V,4);xe(q,{get elements(){return e(U)},selection_changed:Y,get selected_elements(){return e(I)},set selected_elements(x){t(I,x,!0)}}),i(E),i(o),i(g),p(r,g)};T(ve,r=>{e(y)&&e(S)&&e(G)&&e(j).length>0&&e(A).length>0&&r(ue)})}K(()=>m.disabled=e(R)||e(B)),be(m,()=>e(D),r=>t(D,r)),p(a,l)};T(Ie,a=>{!e(B)&&e(v)&&a(Je)})}i(Be),i(je),i(ce);var Ye=n(ce,2),Ke=d(Ye);{var Me=a=>{var l=gt();p(a,l)},Qe=(a,l)=>{{var c=k=>{var m=pt();p(k,m)},z=(k,m)=>{{var oe=P=>{var W=ht();p(P,W)},_e=(P,W)=>{{var ve=r=>{var g=ft();p(r,g)},ue=(r,g)=>{{var o=f=>{var _=yt();p(f,_)},E=(f,_)=>{{var w=b=>{var V=mt();p(b,V)},u=(b,V)=>{{var ge=q=>{var x=bt();p(q,x)},pe=q=>{at(q,{get config(){return e(Pe)},get plot_name(){return e(Ne)}})};T(b,q=>{e(O).length==0?q(ge):q(pe,!1)},V)}};T(f,b=>{e(A).length==0?b(w):b(u,!1)},_)}};T(r,f=>{e(O)==null?f(o):f(E,!1)},g)}};T(P,r=>{e(v)==null?r(ve):r(ue,!1)},W)}};T(k,P=>{e(N).length==0?P(oe):P(_e,!1)},m)}};T(a,k=>{e(j).length==0?k(c):k(z,!1)},l)}};T(Ke,a=>{e(B)||e(R)?a(Me):a(Qe,!1)})}i(Ye),p(se,Ce),We()}Ze(["change"]);export{Bt as component};
