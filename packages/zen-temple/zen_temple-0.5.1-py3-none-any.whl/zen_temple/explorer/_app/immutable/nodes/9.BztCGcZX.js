import"../chunks/CWj6FrbW.js";import{p as ut,a as v,b as p,s as d,f as j,c as ft,d as m,e as s,g as e,u as ke,t as Fe,r as f,h as ht}from"../chunks/DJ4-OfXg.js";import{s as pt}from"../chunks/DpcWkFIJ.js";import{i as O}from"../chunks/DU3kBxd7.js";import{e as mt,i as gt}from"../chunks/DiyBIa6G.js";import{t as S,a as w,c as bt}from"../chunks/BBucZf18.js";import{S as yt,d as M}from"../chunks/pVhPhZzS.js";import{A as B}from"../chunks/HX9qiWDz.js";import{R as xt}from"../chunks/Cjb3PMTS.js";import{T as Ne}from"../chunks/D0AwY0i3.js";import{g as Q}from"../chunks/CqS7hfz2.js";import{r as Y,f as U,B as wt}from"../chunks/BSJu0SI5.js";var Ct=S("Subdivision <!>",1),St=S('<div class="d-flex"><h4> </h4> <!> <!></div>'),Tt=S("<h4>Transport</h4> <!>",1),Ot=S("<h4>Storage</h4> <!>",1),Et=S("<h4>Conversion</h4> <!>",1),jt=S("<h3>Cost of Carrier</h3> <!>",1),zt=S("<h3>Shed Demand</h3> <!>",1),At=S("<h3>Location</h3> <!>",1),Dt=S("<h3>Year</h3> <!>",1),Bt=S('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseCost" aria-expanded="false" aria-controls="collapseCost">Cost selection</button></h2> <div id="collapseCost" class="accordion-collapse collapse show" data-bs-parent="#accordionExample"><div class="accordion-body"></div></div></div> <div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Technology and Carrier Selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show" data-bs-parent="#accordionExample"><div class="accordion-body"><h3>Technologies (for Capex/Opex)</h3> <!> <!> <!> <!> <!></div></div></div> <div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">Data Selection</button></h2> <div id="collapseThree" class="accordion-collapse collapse show" data-bs-parent="#accordionExample"><div class="accordion-body"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Aggregation</h3> <!></div></div> <!> <!></div></div></div></div>',1),Lt=S('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),Rt=S('<div class="text-center">No data with this selection.</div>'),Yt=S('<h2>Costs</h2> <div class="z-1 position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!></div>',1);function Ut(Pe,qe){ut(qe,!0);let ie=v(p([])),ne=v(p([])),k=v(p([])),V=v(p([])),A=v(p([])),a=v(null),F=v(p([])),Ge="not_normalized",N=v(p([])),P=v(p([])),q=v(!1),T=v(!1),W=v(p([])),X=v(p([])),Z=v(p([])),$=v(p([])),L=v(p([])),ee=v(p([])),b,le,G,C=v(void 0),D,H,te=v(p([])),ae=v(p([]));const c="Techology / Carrier",se=[c,"Location"];let oe=v(p(se[1])),ue=v(p({})),h=p({capex:{title:"Capex",show:!0,subdivision:!1},opex:{title:"Opex",show:!0,subdivision:!1},carrier:{title:"Carrier",show:!0,subdivision:!1},shed_demand:{title:"Shed Demand",show:!0,subdivision:!1},carbon_emission:{title:"Carbon Emissions",show:!0,subdivision:!1}});const I=" (Capex)",J=" (Opex)",fe="Capex",he="Opex",pe="Carrier",me="Shed Demand";let ge=v("plot"),R=v(p([])),He=ke(()=>({type:"line",data:{datasets:e(R)},options:{responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Year"}},y:{stacked:!0,title:{display:!0,text:`Costs [${e(L).length>0?e(ue)[e(L)[0]]:""}]`}}}}}));async function Ie(){var o;if(e(a)!=null){s(T,!0),await Fe(),s(C,await M(e(a).solution_name,Q("capex_yearly",e(a).version),e(a).scenario_name,e(a).detail.system.reference_year,e(a).detail.system.interval_between_years),!0),D=await M(e(a).solution_name,Q("opex_yearly",e(a).version),e(a).scenario_name,e(a).detail.system.reference_year,e(a).detail.system.interval_between_years),le=await M(e(a).solution_name,Q("cost_carbon_emissions_total",e(a).version),e(a).scenario_name,e(a).detail.system.reference_year,e(a).detail.system.interval_between_years),G=await M(e(a).solution_name,Q("cost_carrier",e(a).version),e(a).scenario_name,e(a).detail.system.reference_year,e(a).detail.system.interval_between_years),H=await M(e(a).solution_name,Q("cost_shed_demand",e(a).version),e(a).scenario_name,e(a).detail.system.reference_year,e(a).detail.system.interval_between_years),Y(G.data,"node","location"),Y(H.data,"node","location"),Y(D.data,"technology",c),Y(e(C).data,"technology",c),Y(G.data,"carrier",c),Y(H.data,"carrier",c);for(let n in e(C).data.data)e(C).data.data[n][c]=e(C).data.data[n][c]+I;for(let n in D.data.data)D.data.data[n][c]=D.data.data[n][c]+J;(o=e(C).unit)!=null&&o.data&&s(ue,Object.fromEntries(e(C).unit.data.map(n=>[n.technology,n[0]||n.units])),!0),s(V,Object.keys(e(a).detail.edges).concat(e(a).detail.system.set_nodes),!0),s(T,!1)}}function Je(o){s(T,!0),b=new Array;let n=structuredClone(G.data);n.data=n.data.filter(t=>e(N).includes(t[c]));let u=structuredClone(H.data);if(u.data=u.data.filter(t=>e(P).includes(t[c])),e(C)!=null&&h.capex.show)if(h.capex.subdivision)b=b.concat(e(C).data.data);else{let t=U(e(C).data.data,{location:e(A)},{[c]:o},[],!1);for(let i in t)t[i].data.location=t[i].label,t[i].data[c]=fe,b.push(t[i].data)}if(h.opex.show)if(h.opex.subdivision)b=b.concat(D.data.data);else{let t=U(D.data.data,{location:e(A)},{[c]:o},[],!1);for(let i in t)t[i].data.location=t[i].label,t[i].data[c]=he,b.push(t[i].data)}if(h.carrier.show)if(h.carrier.subdivision)b=b.concat(n.data);else{let t=U(n.data,{location:e(A)},{[c]:o},[],!1);for(let i in t)t[i].data.location=t[i].label,t[i].data[c]=pe,b.push(t[i].data)}if(h.shed_demand.show)if(h.shed_demand.subdivision)b=b.concat(u.data);else{let t=U(u.data,{location:e(A)},{[c]:o},[],!1);for(let i in t)t[i].data.location=t[i].label,t[i].data[c]=me,b.push(t[i].data)}if(b.length==0){b=void 0,s(T,!1);return}s(T,!1)}function E(){s(T,!0);let o={},n={},u=[];for(const x of e(ee))u.push(x+I),u.push(x+J);for(const x of e($))u.push(x+I),u.push(x+J);for(const x of e(X))u.push(x+I),u.push(x+J);let t=[...u,...e(N),...e(P)];Je(t),h.capex.subdivision||t.push(fe),h.opex.subdivision||t.push(he),h.carrier.subdivision||t.push(pe),h.shed_demand.subdivision||t.push(me),e(oe)==se[0]?(o.location=e(V),n[c]=t):(o[c]=t,n.location=e(A));let i=e(k).filter(x=>!e(F).includes(x)),_=Ge=="normalized";s(R,[],!0),b&&s(R,U(b,o,n,i,_),!0),le.data.data.length>0&&h.carbon_emission.show&&e(R).push({label:"Total Carbon Costs",data:le.data.data[0],type:"bar"}),s(T,!1)}async function Ke(){var i;if(e(a)==null)return;await Ie(),await Fe(),s(T,!0);let o=new Set;if(e(C)!=null)for(const _ of e(C).data.data)o.add(_[c].replace(I,""));for(const _ of D.data.data)o.add(_[c].replace(J,""));s(W,e(a).detail.system.set_transport_technologies.filter(_=>o.has(_)),!0),s(L,e(a).detail.system.set_conversion_technologies.filter(_=>o.has(_)),!0),s(Z,e(a).detail.system.set_storage_technologies.filter(_=>o.has(_)),!0),s(X,e(W),!0),s(ee,e(L),!0),s($,e(Z),!0);let n=new Set;for(const _ of G.data.data)n.add(_[c]);s(ie,e(a).detail.system.set_carriers.slice(),!0),s(te,e(a).detail.carriers_import.concat(e(a).detail.carriers_export).filter(_=>n.has(_)),!0),s(N,e(te),!0);let u=new Set;for(const _ of H.data.data)u.add(_[c]);s(ae,e(a).detail.carriers_demand.filter(_=>u.has(_)),!0),s(P,e(ae),!0),s(ne,e(a).detail.system.set_nodes,!0),s(F,e(k),!0),s(A,e(V),!0),E(),s(T,!1);let t=e(a).solution_name.split(".");s(ge,[t[(t==null?void 0:t.length)-1],(i=e(a))==null?void 0:i.scenario_name,"costs"].join("_"),!0)}var be=Yt(),de=d(j(be),2),ye=m(de),xe=m(ye),ce=m(xe),we=d(m(ce),2),Ce=m(we),Me=m(Ce);const Qe=ke(()=>!e(q)&&!e(T));yt(Me,{solution_selected:Ke,get enabled(){return e(Qe)},get carriers(){return e(ie)},set carriers(o){s(ie,o,!0)},get nodes(){return e(ne)},set nodes(o){s(ne,o,!0)},get years(){return e(k)},set years(o){s(k,o,!0)},get selected_solution(){return e(a)},set selected_solution(o){s(a,o,!0)},get loading(){return e(q)},set loading(o){s(q,o,!0)}}),f(Ce),f(we),f(ce);var Ue=d(ce,2);{var Ve=o=>{var n=Bt(),u=j(n),t=d(m(u),2),i=m(t);mt(i,21,()=>Object.keys(h),gt,(r,l)=>{var y=St(),g=m(y),lt=m(g);f(g);var Re=d(g,2);Ne(Re,{change:E,get value(){return h[e(l)].show},set value(K){h[e(l)].show=K}});var dt=d(Re,2);{var ct=K=>{var Ye=Ct(),_t=d(j(Ye));Ne(_t,{change:E,get value(){return h[e(l)].subdivision},set value(vt){h[e(l)].subdivision=vt}}),w(K,Ye)};O(dt,K=>{h[e(l)].show&&e(l)!="carbon_emission"&&K(ct)})}f(y),ht(()=>pt(lt,`${h[e(l)].title??""} :`)),w(r,y)}),f(i),f(t),f(u);var _=d(u,2),x=d(m(_),2),re=m(x),z=d(m(re),2);{var _e=r=>{var l=Tt(),y=d(j(l),2);B(y,{get elements(){return e(W)},selection_changed:()=>{E()},get selected_elements(){return e(X)},set selected_elements(g){s(X,g,!0)}}),w(r,l)};O(z,r=>{e(W).length>0&&r(_e)})}var Te=d(z,2);{var $e=r=>{var l=Ot(),y=d(j(l),2);B(y,{get elements(){return e(Z)},selection_changed:()=>{E()},get selected_elements(){return e($)},set selected_elements(g){s($,g,!0)}}),w(r,l)};O(Te,r=>{e(Z).length>0&&r($e)})}var Oe=d(Te,2);{var et=r=>{var l=Et(),y=d(j(l),2);B(y,{get elements(){return e(L)},selection_changed:()=>{E()},get selected_elements(){return e(ee)},set selected_elements(g){s(ee,g,!0)}}),w(r,l)};O(Oe,r=>{e(L).length>0&&r(et)})}var Ee=d(Oe,2);{var tt=r=>{var l=jt(),y=d(j(l),2);B(y,{get elements(){return e(te)},selection_changed:()=>{E()},get selected_elements(){return e(N)},set selected_elements(g){s(N,g,!0)}}),w(r,l)};O(Ee,r=>{e(te).length>0&&r(tt)})}var at=d(Ee,2);{var st=r=>{var l=zt(),y=d(j(l),2);B(y,{get elements(){return e(ae)},selection_changed:()=>{E()},get selected_elements(){return e(P)},set selected_elements(g){s(P,g,!0)}}),w(r,l)};O(at,r=>{e(ae).length>0&&r(st)})}f(re),f(x),f(_);var je=d(_,2),ze=d(m(je),2),Ae=m(ze),De=m(Ae),ve=m(De),Be=m(ve),ot=d(m(Be),2);xt(ot,{options:se,selection_changed:r=>E(),get selected_option(){return e(oe)},set selected_option(r){s(oe,r,!0)}}),f(Be),f(ve);var Le=d(ve,2);{var rt=r=>{var l=At(),y=d(j(l),2);B(y,{get elements(){return e(V)},selection_changed:g=>E(),get selected_elements(){return e(A)},set selected_elements(g){s(A,g,!0)}}),w(r,l)};O(Le,r=>{e(oe)==se[1]&&r(rt)})}var it=d(Le,2);{var nt=r=>{var l=Dt(),y=d(j(l),2);B(y,{get elements(){return e(k)},selection_changed:g=>E(),get selected_elements(){return e(F)},set selected_elements(g){s(F,g,!0)}}),w(r,l)};O(it,r=>{e(F)&&r(nt)})}f(De),f(Ae),f(ze),f(je),w(o,n)};O(Ue,o=>{!e(T)&&!e(q)&&e(C)&&e(a)!=null&&o(Ve)})}f(xe),f(ye),f(de);var Se=d(de,2),We=m(Se);{var Xe=o=>{var n=Lt();w(o,n)},Ze=(o,n)=>{{var u=t=>{var i=bt(),_=j(i);{var x=z=>{var _e=Rt();w(z,_e)},re=z=>{wt(z,{get config(){return e(He)},get plot_name(){return e(ge)}})};O(_,z=>{e(R).length==0||e(R)[0].data.length==0?z(x):z(re,!1)})}w(t,i)};O(o,t=>{e(a)!=null&&t(u)},n)}};O(We,o=>{e(q)||e(T)?o(Xe):o(Ze,!1)})}f(Se),w(Pe,be),ft()}export{Ut as component};
