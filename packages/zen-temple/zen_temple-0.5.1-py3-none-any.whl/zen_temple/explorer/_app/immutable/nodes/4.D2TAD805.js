import"../chunks/CWj6FrbW.js";import{p as ke,a as i,b as O,s as c,f as xe,c as Se,d as l,e as o,g as e,u as p,r as s,t as re}from"../chunks/DJ4-OfXg.js";import{t as P,a as H}from"../chunks/BBucZf18.js";import{i as Y}from"../chunks/DU3kBxd7.js";import{S as ze,g as Ce,a as De}from"../chunks/pVhPhZzS.js";import{D as I}from"../chunks/CDFaqrA9.js";import{f as Oe,B as je}from"../chunks/BSJu0SI5.js";import{g as b}from"../chunks/CqS7hfz2.js";import"../chunks/MU0Q9_bu.js";var Te=P('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Year</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Node</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Carrier</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Smoothing Window Size</h3> <!></div></div></div></div></div>'),We=P('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),Me=P('<div style="position: relative;"><!></div>'),Be=P('<h2>The Energy Balance</h2> <div class="position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!> <!></div>',1);function Re(oe,le){ke(le,!0);var j=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let r=i(null),A=i(!1),g=i(!1),u=i(!1),T=i(O([])),f=i(null),W=i(O([])),y=i(null),x=i(O([])),w=i(null),F=i(""),Z=i("");const se=["Hourly","Daily","Weekly","Monthly"].map(a=>({label:a,value:a}));let K=i("Hourly"),M=i(O([])),$=i(O([]));const ne=p(()=>({type:"line",data:{datasets:e(M),labels:e($)},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,beginAtZero:!0,title:{display:!0,text:`Power [${e(F)}]`}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}}}}));async function ie(){e(r)&&(o(f,e(T)[0],!0),o(y,e(W)[0],!0),o(w,e(x).length>0?e(x)[0].toString():null,!0),o(A,!1),await S())}async function S(){var B;if(o(u,!0),re(),e(f)==null||e(y)==null||e(w)==null||e(r)==null){o(u,!1);return}let a=Math.floor((e(w)-e(r).detail.system.reference_year)/e(r).detail.system.interval_between_years),d=1;switch(e(K)){case"Daily":d=24;break;case"Weekly":d=168;break;case"Monthly":d=720;break}let v=await Ce(e(r).solution_name,e(f),e(y),e(r).scenario_name,a,d),z=await De(e(r).solution_name,b("flow_export",e(r).version),e(r).scenario_name);z===null?o(F,""):o(F,z.data[0][0],!0),o(M,[],!0);let h=0;for(const _ in v){let E={node:[e(f)]};if(v[_]==null||v[_].data.length==0)continue;if("technology"in v[_].data[0]){let t=[];for(const k of v[_].data)t.push(k.technology);E={technology:t}}let C={},D=Oe(v[_].data,E,C);if(D.length!=0)for(let t of D){if(Object.keys(t.data).length==0)continue;switch(_){case b("flow_storage_discharge",e(r).version):t.label=t.label+" (discharge)";break;case b("flow_transport_in",e(r).version):t.label=t.label+" (transport in)";break;case b("flow_import",e(r).version):t.label="Import",e(r).version;break;case b("shed_demand",e(r).version):t.label="Shed Demand";break;case b("flow_storage_charge",e(r).version):t.label=t.label+" (charge)";break;case b("flow_transport_out",e(r).version):t.label=t.label+" (transport out)";break;case b("flow_export",e(r).version):t.label="Export";break}let k="line";Object.keys(t.data).length==1&&(k="bar"),_=="demand"?(t.label="Demand",t.type="line",t.stack="ownCustomStack",t.fill=!1,t.borderColor="black",t.backgroundColor="white",t.borderWidth=2,t.stepped=!0,Object.keys(t.data).length==1&&(t.pointRadius=2)):(t.type=k,t.fill="origin",t.borderColor=j[h%j.length],t.backgroundColor=j[h%j.length].replace(")",", 1)"),t.stepped=!0,t.cubicInterpolationMode="monotone"),e(M).push(t),h++}}o($,Object.keys(e(M)[0].data),!0),o(u,!1),o(A,!0),await re();let m=e(r).solution_name.split(".");o(Z,[m[(m==null?void 0:m.length)-1],(B=e(r))==null?void 0:B.scenario_name,"balance",e(y),e(f),e(w)].join("_"),!0)}var q=Be(),L=c(xe(q),2),G=l(L),J=l(G),N=l(J),Q=c(l(N),2),U=l(Q),de=l(U);const ce=p(()=>!e(g)&&!e(u));ze(de,{solution_selected:ie,get enabled(){return e(ce)},get carriers(){return e(W)},set carriers(a){o(W,a,!0)},get nodes(){return e(T)},set nodes(a){o(T,a,!0)},get years(){return e(x)},set years(a){o(x,a,!0)},get selected_solution(){return e(r)},set selected_solution(a){o(r,a,!0)},get loading(){return e(g)},set loading(a){o(g,a,!0)}}),s(U),s(Q),s(N);var ve=c(N,2);{var ue=a=>{var d=Te(),v=c(l(d),2),z=l(v),h=l(z),m=l(h),B=c(l(m),2);const _=p(()=>e(x).map(n=>({label:n.toString(),value:n.toString()}))),E=p(()=>!e(u)&&!e(g));I(B,{get options(){return e(_)},selection_changed:S,get enabled(){return e(E)},get selected_option(){return e(w)},set selected_option(n){o(w,n,!0)}}),s(m),s(h);var C=c(h,2),D=l(C),t=c(l(D),2);const k=p(()=>e(T).map(n=>({label:n,value:n}))),be=p(()=>!e(u)&&!e(g));I(t,{get options(){return e(k)},selection_changed:S,get enabled(){return e(be)},get selected_option(){return e(f)},set selected_option(n){o(f,n,!0)}}),s(D),s(C);var R=c(C,2),ee=l(R),fe=c(l(ee),2);const he=p(()=>e(W).map(n=>({label:n,value:n}))),me=p(()=>!e(u)&&!e(g));I(fe,{get options(){return e(he)},selection_changed:S,get enabled(){return e(me)},get selected_option(){return e(y)},set selected_option(n){o(y,n,!0)}}),s(ee),s(R);var te=c(R,2),ae=l(te),ye=c(l(ae),2);const we=p(()=>!e(u)&&!e(g));I(ye,{options:se,selection_changed:S,get enabled(){return e(we)},get selected_option(){return e(K)},set selected_option(n){o(K,n,!0)}}),s(ae),s(te),s(z),s(v),s(d),H(a,d)};Y(ve,a=>{!e(g)&&e(r)&&a(ue)})}s(J),s(G),s(L);var V=c(L,2),X=l(V);{var _e=a=>{var d=We();H(a,d)};Y(X,a=>{e(u)&&a(_e)})}var pe=c(X,2);{var ge=a=>{var d=Me(),v=l(d);je(v,{get config(){return e(ne)},get plot_name(){return e(Z)},zoom:!0}),s(d),H(a,d)};Y(pe,a=>{!e(u)&&e(A)&&a(ge)})}s(V),H(oe,q),Se()}export{Re as component};
