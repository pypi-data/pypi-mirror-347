(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{2870:(e,s,a)=>{Promise.resolve().then(a.bind(a,4879))},4879:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>A});var r=a(5155),t=a(2115),n=a(9197),i=a(4649),l=a(954),c=a(2076),o=a(1180),d=a(9409),m=a(5779),u=a(5548),x=a(6236),h=a(6217),v=a(285),j=a(4165),g=a(2523),f=a(7262),p=a(5057),b=a(6102),N=a(8262),y=a(7313),w=a(7280),C=a(6715),S=a(2960),k=a(5041),E=a(4684),_=a(4300),F=a(7652);function A(){console.log("Dashboard Page component rendered");let{darkMode:e,toggleDarkMode:s}=(0,w.D)(),[a,A]=(0,t.useState)(null),[q,T]=(0,t.useState)(null),[R,D]=(0,t.useState)(!0),[I,K]=(0,t.useState)(null),[$,z]=(0,t.useState)([]),[L,B]=(0,t.useState)(""),[V,G]=(0,t.useState)(!1),[O,P]=(0,t.useState)(""),[Q,X]=(0,t.useState)(!0),[J,M]=(0,t.useState)(!1),[Z,U]=(0,t.useState)(!1),[H,W]=(0,t.useState)(()=>{{let e=sessionStorage.getItem("dashboardActiveTab");return e&&sessionStorage.removeItem("dashboardActiveTab"),e||"experiments"}}),[Y,ee]=(0,t.useState)([]),[es,ea]=(0,t.useState)(!1),er=(0,C.jE)(),{data:et,isLoading:en,error:ei,refetch:el}=(0,S.I)({queryKey:["config-versions"],queryFn:E.m0});(0,t.useEffect)(()=>{if(et){let e=et.filter(e=>"current"!==e.version&&e.version.match(/^\d+\.\d+\.\d+$/));e.sort((e,s)=>s.version.localeCompare(e.version,void 0,{numeric:!0})),z(e),e.length>0&&!L&&B(e[0].version)}},[et,L]);let{data:ec,isLoading:eo,error:ed}=(0,S.I)({queryKey:["config",L],queryFn:()=>(0,E.cr)(L),enabled:!!L});(0,t.useEffect)(()=>{ec&&A(ec)},[ec]);let em=(0,k.n)({mutationFn:E.Cg,onSuccess:()=>{(0,N.oR)({title:"Success",description:"Synced version ".concat(L," to main config"),duration:3e3}),er.invalidateQueries({queryKey:["config-versions"]})},onError:e=>{(0,N.oR)({title:"Error",description:"Failed to sync to main config",variant:"destructive",duration:3e3})}}),eu=(0,k.n)({mutationFn:E.yx,onSuccess:e=>{(0,N.oR)({title:"Success",description:"Created version ".concat(null==e?void 0:e.version),duration:3e3}),G(!1),er.invalidateQueries({queryKey:["config-versions"]}),B(e.version)},onError:e=>{(0,N.oR)({title:"Error",description:"Failed to commit new version",variant:"destructive",duration:3e3})}}),ex=(0,k.n)({mutationFn:_.x,onSuccess:(e,s)=>{(0,N.oR)({title:"Success",description:"Agent updated successfully to version ".concat(e.version),duration:3e3}),er.invalidateQueries({queryKey:["config",e.version]}),e.version!==L&&B(e.version)},onError:e=>{(0,N.oR)({title:"Error",description:"Failed to update agent",variant:"destructive",duration:3e3})}}),{data:eh,isLoading:ev,error:ej,refetch:eg}=(0,S.I)({queryKey:["traces"],queryFn:F._K,enabled:"traces"===H});(0,t.useEffect)(()=>{eh&&ee(eh)},[eh]);let ef=async e=>{e&&em.mutate(e)},ep=async()=>O.trim()?L?void eu.mutate({commit_message:O,sync_to_main:Q,source_version:L}):void(0,N.oR)({title:"Error",description:"No version selected to commit from",variant:"destructive",duration:3e3}):void(0,N.oR)({title:"Error",description:"Please enter a commit message",variant:"destructive",duration:3e3}),eb=async e=>{ex.mutate({agent:e,config_version:L})},eN=en||eo&&!!L;(0,t.useEffect)(()=>{console.log("activeTab changed:",H),"traces"===H&&eg()},[H,eg]);let ey=(0,t.useCallback)(e=>{(null==a?void 0:a.agents)&&(T(null),setTimeout(()=>{let s=a.agents.find(s=>s.name===e);s&&(T(s),U(!0))},10))},[a]),ew=(0,t.useCallback)(()=>{T(null),U(!1)},[]),eC=(0,t.useCallback)(()=>{P(""),X(!0),G(!0)},[]),eS=(0,t.useCallback)(e=>{G(e),e||(P(""),X(!0))},[]);return eN&&!a?(0,r.jsx)(l.GB,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:(0,r.jsxs)(l.sF,{children:[(0,r.jsx)(i.D,{}),(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{className:"text-slate-500",children:"Loading..."})})})]})}):ei||ed?(0,r.jsx)(l.GB,{style:{"--sidebar-width":"calc(var(--spacing) * 72)","--header-height":"calc(var(--spacing) * 12)"},children:(0,r.jsxs)(l.sF,{children:[(0,r.jsx)(i.D,{}),(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("p",{className:"text-red-500",children:(null==ei?void 0:ei.message)||(null==ed?void 0:ed.message)})})})]})}):(console.log("activeTab is",H),(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)("main",{className:"flex-1 grid-bg",children:(0,r.jsxs)("div",{className:"container mx-auto py-6",children:[(0,r.jsxs)("div",{className:"mb-8 flex flex-col sm:flex-row sm:items-center gap-4 justify-between  pb-4",children:[(0,r.jsx)("div",{className:"flex-none",children:(0,r.jsx)(y.tU,{value:H,className:"w-full",onValueChange:e=>W(e),children:(0,r.jsxs)(y.j7,{className:"bg-white dark:bg-card p-1 rounded-lg shadow-sm",children:[(0,r.jsx)(y.Xi,{value:"experiments",className:"px-4 py-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground rounded-md transition-all font-medium",children:"Experiments"}),(0,r.jsx)(y.Xi,{value:"traces",className:"px-4 py-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground rounded-md transition-all font-medium",children:"Traces"}),(0,r.jsx)(y.Xi,{value:"evaluations",className:"px-4 py-2 data-[state=active]:bg-primary data-[state=active]:text-primary-foreground rounded-md transition-all font-medium",children:"Evaluations"})]})})}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 ml-auto",children:[(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)(d.l6,{value:L,onValueChange:B,children:[(0,r.jsx)(d.bq,{className:"w-[180px]",children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(m.A,{size:16}),(0,r.jsx)("span",{className:"font-medium",children:L})]})}),(0,r.jsx)(d.gC,{children:$.map(e=>(0,r.jsx)(d.eb,{value:e.version,children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"font-medium",children:e.version}),(0,r.jsx)("span",{className:"text-muted-foreground text-xs truncate",children:e.commit_message})]})},e.version))})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(b.Bc,{children:(0,r.jsxs)(b.m_,{children:[(0,r.jsx)(b.k$,{asChild:!0,children:(0,r.jsxs)(v.$,{variant:"outline",size:"sm",onClick:()=>ef(L),disabled:en,id:"sync-button",className:"relative overflow-hidden group hover:border-primary/50 transition-all duration-300",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-primary/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-in-out"}),(0,r.jsx)(u.A,{size:16,className:"mr-1 group-hover:text-primary transition-colors duration-300"}),(0,r.jsx)("span",{className:"relative z-10",children:"Sync"})]})}),(0,r.jsx)(b.ZI,{children:(0,r.jsx)("p",{children:"This will sync to main agensight.config.json file"})})]})}),(0,r.jsx)(b.Bc,{children:(0,r.jsxs)(b.m_,{children:[(0,r.jsx)(b.k$,{asChild:!0,children:(0,r.jsxs)(v.$,{variant:"outline",size:"sm",onClick:eC,disabled:en,children:[(0,r.jsx)(x.A,{size:16,className:"mr-1"}),"Commit"]})}),(0,r.jsx)(b.ZI,{children:(0,r.jsx)("p",{children:"Save current state as a new version"})})]})})]})]})]}),(0,r.jsxs)("div",{className:"w-full",children:["experiments"===H&&(0,r.jsx)("div",{className:"grid grid-cols-1 gap-6 mb-8",children:(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("div",{className:"rounded-lg border border-border/40 bg-card/50 backdrop-blur-sm p-2 h-[550px] overflow-hidden",children:en?(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):I?(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-destructive",children:I})}):a?(0,r.jsx)(c.A,{agents:a.agents||[],connections:a.connections||[],onNodeClick:ey}):null})})}),"traces"===H&&(0,r.jsx)("div",{className:"border rounded-lg flex flex-col bg-card/50 backdrop-blur-sm h-[550px] pb-0",children:ev?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):Y&&Y.length>0?(0,r.jsx)("div",{className:"flex-1 flex flex-col h-full",children:(0,r.jsx)(n.D,{data:Y})}):(0,r.jsx)("div",{className:"text-center flex items-center justify-center h-full",children:(0,r.jsxs)("div",{children:[(0,r.jsx)(h.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"No traces available"}),(0,r.jsx)("p",{className:"text-muted-foreground mt-2",children:"Trace data will appear here when you run experiments"})]})})}),"evaluations"===H&&(0,r.jsx)("div",{className:"border rounded-lg p-8 flex items-center justify-center bg-card/50 backdrop-blur-sm h-[550px]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(h.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"No evaluation till now"}),(0,r.jsx)("p",{className:"text-muted-foreground mt-2",children:"Evaluation data will appear here when you run experiments"})]})})]})]})}),(0,r.jsx)(j.lG,{open:V,onOpenChange:eS,children:(0,r.jsxs)(j.Cf,{children:[(0,r.jsxs)(j.c7,{children:[(0,r.jsx)(j.L3,{className:"text-xl font-semibold",children:"Create New Version"}),(0,r.jsx)(j.rr,{children:"Save the current configuration as a new version."})]}),(0,r.jsxs)("div",{className:"space-y-4 py-4 px-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(p.J,{htmlFor:"commit-message",className:"font-medium",children:"Commit Message"}),(0,r.jsx)(g.p,{id:"commit-message",placeholder:"Describe your changes",value:O,onChange:e=>P(e.target.value)})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f.S,{id:"sync-to-main",checked:Q,onCheckedChange:e=>{X(!0===e)}}),(0,r.jsx)(p.J,{htmlFor:"sync-to-main",className:"font-medium text-sm",children:"This will sync your changes to the agensight.config.json file"})]})]}),(0,r.jsxs)(j.Es,{children:[(0,r.jsx)(v.$,{variant:"outline",onClick:()=>G(!1),children:"Cancel"}),(0,r.jsx)(v.$,{disabled:en,onClick:ep,children:en?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mr-2 animate-spin h-4 w-4 border-2 border-background border-t-transparent rounded-full"}),"Committing..."]}):"Create Version"})]})]})}),(0,r.jsx)(j.lG,{open:Z,onOpenChange:U,children:(0,r.jsxs)(j.Cf,{className:"sm:max-w-[600px] max-h-[80vh] overflow-hidden border-0 !border-none bg-card/90 backdrop-blur-sm shadow-lg",style:{border:"none"},children:[(0,r.jsx)(j.c7,{className:"border-0 !border-none",style:{borderBottom:"none"},children:(0,r.jsx)(j.L3,{className:"text-xl font-semibold",children:(null==q?void 0:q.name)||"Agent Details"})}),(0,r.jsx)("div",{className:"overflow-auto py-4",children:q&&(0,r.jsx)(o.M,{agent:q,setSelectedAgent:ew,configVersion:L,onSave:eb})})]})})]}))}}},e=>{var s=s=>e(e.s=s);e.O(0,[294,702,920,45,324,29,136,441,684,358],()=>s(2870)),_N_E=e.O()}]);