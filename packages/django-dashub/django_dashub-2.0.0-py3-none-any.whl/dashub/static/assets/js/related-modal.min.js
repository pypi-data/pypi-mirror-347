!function(e){"use strict";let o=0;function a(){return window.top!==window.self}function d(){if(a()){window.parent.dismissModal()}else e(".related-modal-"+o).modal("hide"),o-=1}function t(d,t,n){if(a()){return void window.parent.showModal(d,t,n)}o+=1,e.showModal({title:d,body:t,backdrop:!1,modalDialogClass:"modal-dialog-centered modal-lg",modalClass:"modal fade popupmodal show related-modal-"+o,onDispose:function(){const o=e("div[class*='related-modal-']").last();o&&o.focus()}});const l=e("div[class*='related-modal-']").find("#related-modal-iframe");!0===n.data.lookup&&l.on("load",(function(){e(this).get(0).contentWindow.opener=window}))}function n(o){let a=e(this),d=a.attr("href")||"";if(""===d)return;o.preventDefault(),o.stopImmediatePropagation(),a.blur();let n=a.attr("id"),l=d;const i=a.attr("title");if(!0!==o.data.lookup){let e=String(Math.round(999999*Math.random()));-1===l.indexOf("?")?l+="?_modal="+e:l+="&_modal="+e}-1===l.indexOf("_popup=1")&&(-1===l.indexOf("?")?l+="?_popup=1":l+="&_popup=1");let r='<iframe id="related-modal-iframe" name="'+n+'" src="'+l+'" frameBorder="0" class="related-iframe"></iframe>',s="related-modal";return window.top!==window.self&&(s+=" related-modal__nested"),t(i,r,o),!1}function l(o,a){let d=e(o);d.removeAttr("onclick"),d.unbind("click"),d.click({lookup:a},n)}function i(){l("a.related-widget-wrapper-link",!1),l("a.related-lookup",!0),l("a.dynamic_raw_id-related-lookup",!0)}window.dismissRelatedObjectModal=d,window.dismissRelatedLookupPopup=function(o,t){const n=o.name.replace(/^(change|add|delete|lookup)_/,"");let l;if(a){const a=e("iframe.related-iframe",o.parent.document).eq(-2);let d;d=a.length?a.contents():e(o.parent.document),l=d.find("#"+n)}else l=e("#"+n);const i=l.val();l.hasClass("vManyToManyRawIdAdminField")&&Boolean(i)?l.val(i+", "+t):l.val(t),d()},window.showModal=t,e(document).ready((function(){i()})),e(document).on("formset:added",i)}(jQuery);